{"ast":null,"code":"import axios from \"axios\";\nimport { useRoute } from \"vue-router\";\nimport { getCurrentInstance, onMounted, ref } from \"vue\";\nimport Vue3TagsInput from 'vue3-tags-input';\nexport default {\n  name: \"ShipProfile\",\n  components: {\n    Vue3TagsInput\n  },\n\n  setup() {\n    const route = useRoute();\n    const toast = getCurrentInstance().appContext.config.globalProperties.$toast;\n    let editing = ref(false);\n    let creatingOffer = ref(false);\n    let id = ref(1);\n    let ship = ref({\n      id: Number,\n      name: String,\n      address: String,\n      promoDescription: String,\n      availableFrom: String,\n      availableTo: String,\n      behaviourRules: String,\n      priceList: String,\n      additionalInfo: String,\n      cancellationConditions: String,\n      type: String,\n      length: Number,\n      engineNumber: String,\n      enginePower: Number,\n      topSpeed: Number,\n      clientLimit: Number\n    });\n    let pictures = ref([]);\n    let availabilityInterval = ref([]);\n    let offer = ref({\n      start: String,\n      duration: Number,\n      clientLimit: \"\",\n      additionalServices: [],\n      price: \"\",\n      id: null,\n      place: ship.value.address,\n      rentingEntityId: ship.value.id\n    });\n    let offerInterval = ref([]);\n    let tags = ref([]);\n    onMounted(() => {\n      if (route.params.id !== undefined) {\n        id.value = route.params.id;\n      }\n\n      axios.get(`/api/ships/${id.value}`).then(response => {\n        ship.value = response.data;\n        availabilityInterval.value = [stringToDateTime(ship.value.availableFrom), stringToDateTime(ship.value.availableTo)];\n      });\n      axios.get(`/api/ships/${id.value}/pictures/all`).then(response => {\n        for (let i = 0; i < response.data.length; i++) {\n          pictures.value.push(response.data[i]);\n        }\n      });\n    });\n\n    function toggleEdit() {\n      editing.value = true;\n    }\n\n    function toggleCreatingOffer() {\n      creatingOffer.value = true;\n    }\n\n    function cancel() {\n      editing.value = false;\n      creatingOffer.value = false;\n    }\n\n    function saveEdit() {\n      ship.value.availableFrom = dateTimeToString(availabilityInterval.value[0]);\n      ship.value.availableTo = dateTimeToString(availabilityInterval.value[1]);\n      axios.put(`/api/ships/${id.value}`, ship.value).then(response => {\n        ship.value = response.data;\n        toast.success(\"Info updated\");\n      });\n      editing.value = false;\n    }\n\n    function createOffer() {\n      offer.value.start = dateTimeToString(offerInterval.value[0]);\n      offer.value.duration = offerInterval.value[1] - offerInterval.value[0];\n      offer.value.place = ship.value.address;\n      offer.value.rentingEntityId = parseInt(id.value);\n      axios.post(\"/api/offers/new\", offer.value).then(response => {\n        offer.value = response.data;\n        toast.success(\"Info updated\");\n      });\n      creatingOffer.value = false;\n    }\n\n    function updateTags(tags) {\n      offer.value.additionalServices = tags;\n    }\n\n    function stringToDateTime(s) {\n      let tokens = s.split(\" \");\n      let date = tokens[0];\n      let time = tokens[1];\n      tokens = date.split(\".\");\n      let day = parseInt(tokens[0]);\n      let month = parseInt(tokens[1]) - 1;\n      let year = parseInt(tokens[2]);\n      tokens = time.split(\":\");\n      let hour = parseInt(tokens[0]);\n      let minute = parseInt(tokens[1]);\n      return new Date(year, month, day, hour, minute);\n    }\n\n    function dateTimeToString(dt) {\n      let day = (\"0\" + dt.getDate()).slice(-2);\n      let month = (\"0\" + (dt.getMonth() + 1)).slice(-2);\n      let year = dt.getFullYear();\n      let hour = (\"0\" + dt.getHours()).slice(-2);\n      let minute = (\"0\" + dt.getMinutes()).slice(-2);\n      return `${day}.${month}.${year} ${hour}:${minute}`;\n    }\n\n    const formatRange = dates => {\n      let from = dates[0];\n      let to = dates[1];\n      const dayFrom = from.getDate();\n      const monthFrom = from.getMonth() + 1;\n      const yearFrom = from.getFullYear();\n      const hourFrom = from.getHours();\n      const minuteFrom = from.getMinutes();\n      const dayTo = to.getDate();\n      const monthTo = to.getMonth() + 1;\n      const yearTo = to.getFullYear();\n      const hourTo = to.getHours();\n      const minuteTo = to.getMinutes();\n      return `${dayFrom}.${monthFrom}.${yearFrom} ${hourFrom}:${minuteFrom} - ${dayTo}.${monthTo}.${yearTo} ${hourTo}:${minuteTo}`;\n    };\n\n    return {\n      editing,\n      creatingOffer,\n      ship,\n      pictures,\n      availabilityInterval,\n      offer,\n      offerInterval,\n      tags,\n      toggleEdit,\n      toggleCreatingOffer,\n      cancel,\n      saveEdit,\n      createOffer,\n      updateTags,\n      formatRange\n    };\n  }\n\n};","map":{"version":3,"mappings":"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","names":["axios","useRoute","getCurrentInstance","onMounted","ref","Vue3TagsInput","name","components","setup","route","toast","appContext","config","globalProperties","$toast","editing","creatingOffer","id","ship","Number","String","address","promoDescription","availableFrom","availableTo","behaviourRules","priceList","additionalInfo","cancellationConditions","type","length","engineNumber","enginePower","topSpeed","clientLimit","pictures","availabilityInterval","offer","start","duration","additionalServices","price","place","value","rentingEntityId","offerInterval","tags","params","undefined","get","then","response","data","stringToDateTime","i","push","toggleEdit","toggleCreatingOffer","cancel","saveEdit","dateTimeToString","put","success","createOffer","parseInt","post","updateTags","s","tokens","split","date","time","day","month","year","hour","minute","Date","dt","getDate","slice","getMonth","getFullYear","getHours","getMinutes","formatRange","dates","from","to","dayFrom","monthFrom","yearFrom","hourFrom","minuteFrom","dayTo","monthTo","yearTo","hourTo","minuteTo"],"sourceRoot":"","sources":["C:\\Users\\draga\\OneDrive\\Dokumenti\\MRS-ISA-PROJEKAT\\mrs-isa-projekat\\projekat\\src\\frontend\\src\\components\\ShipProfile.vue"],"sourcesContent":["<template>\r\n  <div class=\"main-container\">\r\n    <div class=\"heading-flex\">\r\n      <div class=\"heading-left\">\r\n        <h3 class=\"main-heading\">{{ship.name}}</h3>\r\n        <vue3-star-ratings class=\"star-ratings\" v-model=\"ship.rating\" starSize=\"22\"  :showControl=false :disableClick=true :step=0 />\r\n        <h5 class=\"star-heading\">({{ship.reviewsNumber}})</h5>\r\n      </div>\r\n      <div class=\"heading-right\">\r\n        <div class=\"heading-right-buttons\">\r\n          <button style=\"margin-right: 20px\" type=\"button\" @click=\"toggleEdit()\" class=\"custom-btn button-primary\" data-bs-toggle=\"modal\" data-bs-target=\"#modal\">Edit info</button>\r\n          <button type=\"button\" @click=\"toggleCreatingOffer()\" class=\"custom-btn button-primary\" data-bs-toggle=\"modal\" data-bs-target=\"#modalOffer\">Create offer</button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n    <div id=\"carouselExampleControls\" class=\"carousel slide\" data-bs-ride=\"carousel\">\r\n      <div class=\"carousel-inner\">\r\n        <div class=\"carousel-item active\">\r\n          <img class=\"carousel-image d-block w-100\" alt=\"Active picture\" v-bind:src=\"'data:image/jpeg;base64,' + pictures.at(0)\">\r\n        </div>\r\n        <div class=\"carousel-item\" v-for=\"(picture, index) in pictures.slice(1)\" :key=\"index\">\r\n          <img class=\"carousel-image d-block w-100\" alt=\"Item picture\" v-bind:src=\"'data:image/jpeg;base64,' + picture\">\r\n        </div>\r\n      </div>\r\n      <button class=\"carousel-control-prev\" type=\"button\" data-bs-target=\"#carouselExampleControls\" data-bs-slide=\"prev\">\r\n        <span class=\"carousel-control-prev-icon\" aria-hidden=\"true\"></span>\r\n        <span class=\"visually-hidden\">Previous</span>\r\n      </button>\r\n      <button class=\"carousel-control-next\" type=\"button\" data-bs-target=\"#carouselExampleControls\" data-bs-slide=\"next\">\r\n        <span class=\"carousel-control-next-icon\" aria-hidden=\"true\"></span>\r\n        <span class=\"visually-hidden\">Next</span>\r\n      </button>\r\n    </div>\r\n    <div class=\"main-description\">\r\n      <div class=\"inner-description\">\r\n        <div><b>Address: </b> {{ship.address}}</div>\r\n        <div><b>Description: </b> {{ship.promoDescription}}</div>\r\n        <div><b>Behaviour rules: </b> {{ship.behaviourRules}}</div>\r\n        <div><b>Price: </b> {{ship.priceList}} per day</div>\r\n        <div><b>Additional info: </b>{{ship.additionalInfo}}</div>\r\n        <div><b>Cancellation conditions: </b>{{ship.cancellationConditions}}</div>\r\n        <div><b>Type: </b>{{ship.type}}</div>\r\n        <div><b>Length: </b>{{ship.length}}</div>\r\n        <div><b>Engine Number: </b>{{ship.engineNumber}}</div>\r\n        <div><b>Engine Power: </b>{{ship.enginePower}}</div>\r\n        <div><b>Top Speed: </b>{{ship.topSpeed}}</div>\r\n        <div><b>Client Limit: </b>{{ship.clientLimit}}</div>\r\n        <div><b>Availability:</b> From {{ship.availableFrom}} to {{ship.availableTo}}</div>\r\n      </div>\r\n      <div class=\"google-map-container\">\r\n        <iframe class=\"google-map\" v-bind:src=\"'https://maps.google.com/maps?q=' + ship.address + '&t=&z=13&ie=UTF8&iwloc=&output=embed'\"></iframe>\r\n      </div>\r\n    </div>\r\n    <hr>\r\n<!--    UBACITI KALENDAR OVDE-->\r\n  </div>\r\n  <div class=\"modal fade\" id=\"modal\" tabindex=\"-1\" aria-hidden=\"true\">\r\n    <div class=\"modal-dialog modal-lg\">\r\n      <div class=\"modal-content\">\r\n        <div class=\"modal-body\">\r\n          <div class=\"form-floating mb-3\">\r\n            <input v-model=\"ship.name\" type=\"text\" class=\"form-control\" id=\"floatName\" placeholder=\"Title\">\r\n            <label for=\"floatName\">Title</label>\r\n          </div>\r\n          <div class=\"form-floating mb-3\">\r\n            <input v-model=\"ship.address\" type=\"text\" class=\"form-control\" id=\"floatAddress\" placeholder=\"Address\">\r\n            <label for=\"floatAddress\">Address</label>\r\n          </div>\r\n          <div class=\"form-floating mb-3\">\r\n            <textarea style=\"height: 100px\" v-model=\"ship.promoDescription\" type=\"text\" class=\"form-control\" id=\"floatPromoDescription\" placeholder=\"Description\"></textarea>\r\n            <label for=\"floatPromoDescription\">Description</label>\r\n          </div>\r\n          <div class=\"form-floating mb-3\">\r\n            <textarea style=\"height: 100px\" v-model=\"ship.behaviourRules\" type=\"text\" class=\"form-control\" id=\"floatBehaviourRules\" placeholder=\"Behaviour rules\"></textarea>\r\n            <label for=\"floatBehaviourRules\">Behaviour rules</label>\r\n          </div>\r\n          <div class=\"form-floating mb-3\">\r\n            <input v-model=\"ship.priceList\" type=\"text\" class=\"form-control\" id=\"floatPriceList\" placeholder=\"Price\">\r\n            <label for=\"floatPriceList\">Price</label>\r\n          </div>\r\n          <div class=\"form-floating mb-3\">\r\n            <textarea style=\"height: 100px\" v-model=\"ship.additionalInfo\" type=\"text\" class=\"form-control\" id=\"floatAdditionalInfo\" placeholder=\"Additional info\"></textarea>\r\n            <label for=\"floatAdditionalInfo\">Additional info</label>\r\n          </div>\r\n          <div class=\"form-floating mb-3\">\r\n            <input v-model=\"ship.cancellationConditions\" type=\"text\" class=\"form-control\" id=\"floatCancellationConditions\" placeholder=\"Cancellation conditions\">\r\n            <label for=\"floatCancellationConditions\">Cancellation conditions</label>\r\n          </div>\r\n          <div class=\"form-floating mb-3\">\r\n            <input v-model=\"ship.type\" type=\"text\" class=\"form-control\" id=\"floatType\" placeholder=\"Type\">\r\n            <label for=\"floatType\">Type</label>\r\n          </div>\r\n          <div class=\"form-floating mb-3\">\r\n            <input v-model=\"ship.length\" type=\"text\" class=\"form-control\" id=\"flotLength\" placeholder=\"Length\">\r\n            <label for=\"flotLength\">Type</label>\r\n          </div>\r\n          <div class=\"form-floating mb-3\">\r\n            <input v-model=\"ship.engineNumber\" type=\"text\" class=\"form-control\" id=\"floatEngineNumber\" placeholder=\"Engine number\">\r\n            <label for=\"floatEngineNumber\">Engine number</label>\r\n          </div>\r\n          <div class=\"form-floating mb-3\">\r\n            <input v-model=\"ship.enginePower\" type=\"text\" class=\"form-control\" id=\"floatEnginePower\" placeholder=\"Engine power\">\r\n            <label for=\"floatEnginePower\">Engine power</label>\r\n          </div>\r\n          <div class=\"form-floating mb-3\">\r\n            <input v-model=\"ship.topSpeed\" type=\"text\" class=\"form-control\" id=\"floatTopSpeed\" placeholder=\"Top speed\">\r\n            <label for=\"floatTopSpeed\">Top speed</label>\r\n          </div>\r\n          <div class=\"form-floating mb-3\">\r\n            <input v-model=\"ship.clientLimit\" type=\"text\" class=\"form-control\" id=\"floatClientLimit\" placeholder=\"Client limit\">\r\n            <label for=\"floatClientLimit\">Client limit</label>\r\n          </div>\r\n          <Datepicker v-model=\"availabilityInterval\" :format=\"formatRange\" range/>\r\n        </div>\r\n        <div class=\"modal-footer\">\r\n          <button type=\"button\" @click=\"cancel()\" class=\"custom-btn button-primary\" data-bs-dismiss=\"modal\">Close</button>\r\n          <button type=\"button\" @click=\"saveEdit()\" class=\"custom-btn button-primary\" data-bs-dismiss=\"modal\">Save changes</button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n  <div class=\"modal fade\" id=\"modalOffer\" tabindex=\"-1\" aria-hidden=\"true\">\r\n    <div class=\"modal-dialog\">\r\n      <div class=\"modal-content\">\r\n        <div class=\"modal-body\">\r\n          <div class=\"form-floating mb-3\">\r\n            <input v-model=\"offer.clientLimit\" type=\"text\" class=\"form-control\" id=\"floatClientLimitOffer\" placeholder=\"Client limit\">\r\n            <label for=\"floatClientLimitOffer\">Client limit</label>\r\n          </div>\r\n          <div class=\"form-floating mb-3\">\r\n            <input v-model=\"offer.price\" type=\"text\" class=\"form-control\" id=\"floatPrice\" placeholder=\"Price\">\r\n            <label for=\"floatPrice\">Price</label>\r\n          </div>\r\n          <div class=\"mb-3\">\r\n            Additional Services:\r\n            <vue3-tags-input style=\"height: 100px\" :tags=\"offer.additionalServices\" @on-tags-changed=\"updateTags\" class=\"form-control\" aria-label=\"Username\" aria-describedby=\"additionalServicesOffer\"/>\r\n          </div>\r\n<!--          IZMENITI NA NOVI DATEPICKER-->\r\n          <Datepicker v-model=\"offerInterval\" :format=\"formatRange\" range/>\r\n        </div>\r\n        <div class=\"modal-footer\">\r\n          <button type=\"button\" @click=\"cancel()\" class=\"custom-btn button-primary\" data-bs-dismiss=\"modal\">Close</button>\r\n          <button type=\"button\" @click=\"createOffer()\" class=\"custom-btn button-primary\" data-bs-dismiss=\"modal\">Save changes</button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport axios from \"axios\";\r\nimport {useRoute} from \"vue-router\";\r\nimport {getCurrentInstance, onMounted, ref} from \"vue\";\r\nimport Vue3TagsInput from 'vue3-tags-input';\r\n\r\nexport default {\r\n  name: \"ShipProfile\",\r\n  components: {\r\n    Vue3TagsInput\r\n  },\r\n  setup() {\r\n    const route = useRoute();\r\n    const toast = getCurrentInstance().appContext.config.globalProperties.$toast;\r\n\r\n    let editing = ref(false);\r\n    let creatingOffer = ref(false);\r\n\r\n    let id = ref(1);\r\n    let ship = ref({\r\n      id: Number,\r\n      name: String,\r\n      address: String,\r\n      promoDescription: String,\r\n      availableFrom: String,\r\n      availableTo: String,\r\n      behaviourRules: String,\r\n      priceList: String,\r\n      additionalInfo: String,\r\n      cancellationConditions: String,\r\n      type: String,\r\n      length: Number,\r\n      engineNumber: String,\r\n      enginePower: Number,\r\n      topSpeed: Number,\r\n      clientLimit: Number\r\n    });\r\n    let pictures = ref([]);\r\n    let availabilityInterval = ref([]);\r\n\r\n    let offer = ref({\r\n      start: String,\r\n      duration: Number,\r\n      clientLimit: \"\",\r\n      additionalServices: [],\r\n      price: \"\",\r\n\r\n      id: null,\r\n      place: ship.value.address,\r\n      rentingEntityId: ship.value.id\r\n    });\r\n    let offerInterval = ref([]);\r\n\r\n    let tags = ref([]);\r\n\r\n    onMounted(() => {\r\n      if (route.params.id !== undefined) {\r\n        id.value = route.params.id;\r\n      }\r\n      axios\r\n          .get(`/api/ships/${id.value}`)\r\n          .then(response => {\r\n            ship.value = response.data;\r\n            availabilityInterval.value = [stringToDateTime(ship.value.availableFrom),\r\n                                          stringToDateTime(ship.value.availableTo)];\r\n          });\r\n      axios\r\n          .get(`/api/ships/${id.value}/pictures/all`)\r\n          .then(response => {\r\n            for (let i = 0; i < response.data.length; i++) {\r\n              pictures.value.push(response.data[i]);\r\n            }\r\n          });\r\n    });\r\n\r\n    function toggleEdit() {\r\n      editing.value = true;\r\n    }\r\n\r\n    function toggleCreatingOffer() {\r\n      creatingOffer.value = true;\r\n    }\r\n\r\n    function cancel() {\r\n      editing.value = false;\r\n      creatingOffer.value = false;\r\n    }\r\n\r\n    function saveEdit(){\r\n      ship.value.availableFrom = dateTimeToString(availabilityInterval.value[0]);\r\n      ship.value.availableTo = dateTimeToString(availabilityInterval.value[1]);\r\n\r\n      axios\r\n          .put(`/api/ships/${id.value}`, ship.value)\r\n          .then(response => {\r\n            ship.value = response.data;\r\n            toast.success(\"Info updated\");\r\n          });\r\n\r\n      editing.value = false;\r\n    }\r\n\r\n    function createOffer() {\r\n      offer.value.start = dateTimeToString(offerInterval.value[0]);\r\n      offer.value.duration = offerInterval.value[1] - offerInterval.value[0];\r\n      offer.value.place = ship.value.address;\r\n      offer.value.rentingEntityId = parseInt(id.value);\r\n\r\n      axios\r\n          .post(\"/api/offers/new\", offer.value)\r\n          .then(response => {\r\n            offer.value = response.data;\r\n            toast.success(\"Info updated\");\r\n          });\r\n\r\n      creatingOffer.value = false;\r\n    }\r\n\r\n    function updateTags(tags) {\r\n      offer.value.additionalServices = tags;\r\n    }\r\n\r\n    function stringToDateTime(s) {\r\n      let tokens = s.split(\" \");\r\n      let date = tokens[0];\r\n      let time = tokens[1];\r\n\r\n      tokens = date.split(\".\");\r\n      let day = parseInt(tokens[0]);\r\n      let month = parseInt(tokens[1]) - 1;\r\n      let year = parseInt(tokens[2]);\r\n\r\n      tokens = time.split(\":\");\r\n      let hour = parseInt(tokens[0]);\r\n      let minute = parseInt(tokens[1]);\r\n\r\n      return new Date(year, month, day, hour, minute);\r\n    }\r\n\r\n    function dateTimeToString(dt) {\r\n      let day = (\"0\" + dt.getDate()).slice(-2);\r\n      let month = (\"0\" + (dt.getMonth() + 1)).slice(-2);\r\n      let year = dt.getFullYear();\r\n      let hour = (\"0\" + dt.getHours()).slice(-2);\r\n      let minute = (\"0\" + dt.getMinutes()).slice(-2);\r\n      return `${day}.${month}.${year} ${hour}:${minute}`;\r\n    }\r\n\r\n    const formatRange = (dates) => {\r\n      let from = dates[0];\r\n      let to = dates[1];\r\n\r\n      const dayFrom = from.getDate();\r\n      const monthFrom = from.getMonth() + 1;\r\n      const yearFrom = from.getFullYear();\r\n      const hourFrom = from.getHours();\r\n      const minuteFrom = from.getMinutes();\r\n\r\n      const dayTo = to.getDate();\r\n      const monthTo = to.getMonth() + 1;\r\n      const yearTo = to.getFullYear();\r\n      const hourTo = to.getHours();\r\n      const minuteTo = to.getMinutes();\r\n\r\n      return `${dayFrom}.${monthFrom}.${yearFrom} ${hourFrom}:${minuteFrom} - ${dayTo}.${monthTo}.${yearTo} ${hourTo}:${minuteTo}`\r\n    }\r\n\r\n    return {\r\n      editing,\r\n      creatingOffer,\r\n      ship,\r\n      pictures,\r\n      availabilityInterval,\r\n      offer,\r\n      offerInterval,\r\n      tags,\r\n      toggleEdit,\r\n      toggleCreatingOffer,\r\n      cancel,\r\n      saveEdit,\r\n      createOffer,\r\n      updateTags,\r\n      formatRange\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n\r\n</style>"]},"metadata":{},"sourceType":"module"}