{"ast":null,"code":"import { onMounted, ref } from \"vue\";\nimport { useRouter } from \"vue-router\";\nimport axios from \"axios\";\nexport default {\n  name: \"OwnerInfo\",\n\n  setup() {\n    const router = useRouter(); // const root = getCurrentInstance();\n\n    let entityTypeInfo = ref({\n      urlPart: \"\"\n    });\n    let owner = ref({\n      id: null,\n      email: null,\n      username: null,\n      firstName: null,\n      lastName: null,\n      address: null,\n      city: null,\n      country: null,\n      phoneNum: null,\n      penalties: null,\n      accountType: null\n    });\n    let phoneNum = ref(null);\n    let validatedPhoneNum = ref(\"\");\n    let picture = ref(\"\");\n    let page = ref(\"homePage\");\n    onMounted(() => {\n      axios.get(\"/api/users/loggedUser\", {\n        headers: {\n          \"Authorization\": `Bearer ${localStorage.getItem(\"jwt\")}`\n        }\n      }).then(response => {\n        owner.value = response.data;\n\n        if (response.data.accountType === \"VH_OWNER\") {\n          entityTypeInfo.value = {\n            urlPart: \"vacationHouseOwners\"\n          };\n        } else if (response.data.accountType === \"SH_OWNER\") {\n          entityTypeInfo.value = {\n            urlPart: \"shipOwners\"\n          }; // else if INSTRUCTOR, ADMIN\n        } else {\n          router.push({\n            name: \"homePage\"\n          });\n        }\n      }).catch(error => {\n        console.log(error.response); // root.accessToken = null;\n        // localStorage.setItem(\"jwt\", null);\n        // router.push(\"/loginPage\");\n      });\n      axios.get(\"/api/users/loggedUser/picture\", {\n        headers: {\n          \"Authorization\": `Bearer ${localStorage.getItem(\"jwt\")}`\n        }\n      }).then(response => picture.value = response.data).catch(error => {\n        console.log(error.response);\n      });\n    });\n\n    function telValidate(phoneNumber) {\n      if (phoneNumber.valid) {\n        validatedPhoneNum.value = phoneNumber.number;\n      } else {\n        validatedPhoneNum.value = '';\n      }\n    }\n\n    function saveInfoEdit() {\n      if (validatedPhoneNum.value !== \"\") owner.value.phoneNum = validatedPhoneNum.value;\n      axios.put(`/api/${entityTypeInfo.value.urlPart}/${owner.value.id}`, owner.value, {\n        headers: {\n          \"Authorization\": `Bearer ${localStorage.getItem(\"jwt\")}`\n        }\n      }).then(response => {\n        owner.value = response.data;\n        console.log(\"Info updated\");\n      }).catch(error => {\n        console.log(error.response);\n      });\n    }\n\n    return {\n      owner,\n      phoneNum,\n      picture,\n      page,\n      telValidate,\n      saveInfoEdit\n    };\n  }\n\n};","map":{"version":3,"mappings":"AAkEA,SAAQA,SAAR,EAAmBC,GAAnB,QAA6B,KAA7B;AACA,SAAQC,SAAR,QAAwB,YAAxB;AACA,OAAOC,KAAP,MAAkB,OAAlB;AAEA,eAAe;AACbC,MAAI,EAAE,WADO;;AAEbC,OAAK,GAAG;AACN,UAAMC,MAAK,GAAIJ,SAAS,EAAxB,CADM,CAEN;;AAEA,QAAIK,cAAa,GAAIN,GAAG,CAAC;AACvBO,aAAO,EAAE;AADc,KAAD,CAAxB;AAIA,QAAIC,KAAI,GAAIR,GAAG,CAAC;AACdS,QAAE,EAAE,IADU;AAEdC,WAAK,EAAE,IAFO;AAGdC,cAAQ,EAAE,IAHI;AAIdC,eAAS,EAAE,IAJG;AAKdC,cAAQ,EAAE,IALI;AAMdC,aAAO,EAAE,IANK;AAOdC,UAAI,EAAE,IAPQ;AAQdC,aAAO,EAAE,IARK;AASdC,cAAQ,EAAE,IATI;AAUdC,eAAS,EAAE,IAVG;AAWdC,iBAAW,EAAE;AAXC,KAAD,CAAf;AAaA,QAAIF,QAAO,GAAIjB,GAAG,CAAC,IAAD,CAAlB;AACA,QAAIoB,iBAAgB,GAAIpB,GAAG,CAAC,EAAD,CAA3B;AACA,QAAIqB,OAAM,GAAIrB,GAAG,CAAC,EAAD,CAAjB;AACA,QAAIsB,IAAG,GAAItB,GAAG,CAAC,UAAD,CAAd;AAEAD,aAAS,CAAC,MAAM;AACdG,WAAI,CACCqB,GADL,CACS,uBADT,EAEQ;AAAEC,eAAO,EAAE;AAAE,2BAAmB,UAASC,YAAY,CAACC,OAAb,CAAqB,KAArB,CAA4B;AAA1D;AAAX,OAFR,EAGKC,IAHL,CAGUC,QAAO,IAAK;AAChBpB,aAAK,CAACqB,KAAN,GAAcD,QAAQ,CAACE,IAAvB;;AAEA,YAAGF,QAAQ,CAACE,IAAT,CAAcX,WAAd,KAA8B,UAAjC,EAA6C;AAC3Cb,wBAAc,CAACuB,KAAf,GAAuB;AACrBtB,mBAAO,EAAE;AADY,WAAvB;AAIF,SALA,MAKO,IAAIqB,QAAQ,CAACE,IAAT,CAAcX,WAAd,KAA8B,UAAlC,EAA8C;AACnDb,wBAAc,CAACuB,KAAf,GAAuB;AACrBtB,mBAAO,EAAE;AADY,WAAvB,CADmD,CAKnD;AAEF,SAPO,MAOA;AACLF,gBAAM,CAAC0B,IAAP,CAAY;AAAC5B,gBAAI,EAAE;AAAP,WAAZ;AACF;AACD,OArBL,EAsBK6B,KAtBL,CAsBWC,KAAI,IAAK;AACdC,eAAO,CAACC,GAAR,CAAYF,KAAK,CAACL,QAAlB,EADc,CAEd;AACA;AACA;AACD,OA3BL;AA4BA1B,WAAI,CACCqB,GADL,CACS,+BADT,EAEQ;AAAEC,eAAO,EAAE;AAAC,2BAAmB,UAASC,YAAY,CAACC,OAAb,CAAqB,KAArB,CAA4B;AAAzD;AAAX,OAFR,EAGKC,IAHL,CAGUC,QAAO,IAAMP,OAAO,CAACQ,KAAR,GAAgBD,QAAQ,CAACE,IAHhD,EAIKE,KAJL,CAIYC,KAAD,IAAW;AAChBC,eAAO,CAACC,GAAR,CAAYF,KAAK,CAACL,QAAlB;AACD,OANL;AAOD,KApCQ,CAAT;;AAsCA,aAASQ,WAAT,CAAqBC,WAArB,EAAkC;AAChC,UAAIA,WAAW,CAACC,KAAhB,EAAuB;AACrBlB,yBAAiB,CAACS,KAAlB,GAA0BQ,WAAW,CAACE,MAAtC;AACF,OAFA,MAEO;AACLnB,yBAAiB,CAACS,KAAlB,GAA0B,EAA1B;AACF;AACF;;AAEA,aAASW,YAAT,GAAuB;AACrB,UAAIpB,iBAAiB,CAACS,KAAlB,KAA4B,EAAhC,EACErB,KAAK,CAACqB,KAAN,CAAYZ,QAAZ,GAAuBG,iBAAiB,CAACS,KAAzC;AAEF3B,WAAI,CACCuC,GADL,CACU,QAAOnC,cAAc,CAACuB,KAAf,CAAqBtB,OAAQ,IAAGC,KAAK,CAACqB,KAAN,CAAYpB,EAAG,EADhE,EACmED,KAAK,CAACqB,KADzE,EAEQ;AAAEL,eAAO,EAAE;AAAC,2BAAmB,UAASC,YAAY,CAACC,OAAb,CAAqB,KAArB,CAA4B;AAAzD;AAAX,OAFR,EAGKC,IAHL,CAGUC,QAAO,IAAK;AAChBpB,aAAK,CAACqB,KAAN,GAAcD,QAAQ,CAACE,IAAvB;AACAI,eAAO,CAACC,GAAR,CAAY,cAAZ;AACD,OANL,EAOKH,KAPL,CAOWC,KAAI,IAAK;AACdC,eAAO,CAACC,GAAR,CAAYF,KAAK,CAACL,QAAlB;AACD,OATL;AAUF;;AAEA,WAAO;AACLpB,WADK;AAELS,cAFK;AAGLI,aAHK;AAILC,UAJK;AAKLc,iBALK;AAMLI;AANK,KAAP;AAQF;;AAlGa,CAAf","names":["onMounted","ref","useRouter","axios","name","setup","router","entityTypeInfo","urlPart","owner","id","email","username","firstName","lastName","address","city","country","phoneNum","penalties","accountType","validatedPhoneNum","picture","page","get","headers","localStorage","getItem","then","response","value","data","push","catch","error","console","log","telValidate","phoneNumber","valid","number","saveInfoEdit","put"],"sourceRoot":"","sources":["C:\\Users\\draga\\OneDrive\\Dokumenti\\MRS-ISA-PROJEKAT\\mrs-isa-projekat\\projekat\\src\\frontend\\src\\components\\user_profiles\\owner_profiles\\OwnerInfo.vue"],"sourcesContent":["<template>\r\n<!--  <h3>Profile Information</h3>-->\r\n  <div class=\"main-description\">\r\n    <div class=\"picture-container me-5 text-center\">\r\n      <img class=\"picture rounded-3 mb-3\" v-bind:src=\"'data:image/jpeg;base64,' + picture\" alt=\"Profile picture\">\r\n\r\n    </div>\r\n    <div class=\"inner-description\">\r\n      <div><b>First Name: </b> {{owner.firstName}}</div>\r\n      <div><b>Last Name: </b> {{owner.lastName}}</div>\r\n      <div><b>E-mail: </b> {{owner.email}}</div>\r\n      <div><b>Address: </b> {{owner.address}}</div>\r\n      <div><b>Place: </b> {{owner.city}}</div>\r\n      <div><b>Country: </b> {{owner.country}}</div>\r\n      <div><b>Phone Number: </b> {{owner.phoneNum}}</div>\r\n    </div>\r\n  </div>\r\n\r\n  <div class=\"modal-button-div\">\r\n    <button type=\"button\" class=\"custom-btn button-primary me-5\" data-bs-toggle=\"modal\" data-bs-target=\"#pictureModal\">Change Picture</button>\r\n    <button type=\"button\" class=\"custom-btn button-primary\" data-bs-toggle=\"modal\" data-bs-target=\"#infoModal\">Change Info</button>\r\n  </div>\r\n\r\n  <div class=\"modal fade\" id=\"infoModal\" tabindex=\"-1\" aria-hidden=\"true\">\r\n    <div class=\"modal-dialog modal-lg\">\r\n      <div class=\"modal-content\">\r\n        <div class=\"modal-body\">\r\n          <div class=\"form-floating mb-3\">\r\n            <input v-model=\"owner.firstName\" type=\"text\" class=\"form-control\" id=\"modalFirstName\" placeholder=\"First Name\">\r\n            <label for=\"modalFirstName\">First Name</label>\r\n          </div>\r\n          <div class=\"form-floating mb-3\">\r\n            <input v-model=\"owner.lastName\" type=\"text\" class=\"form-control\" id=\"modalLastName\" placeholder=\"Last Name\">\r\n            <label for=\"modalLastName\">Last Name</label>\r\n          </div>\r\n          <div class=\"form-floating mb-3\">\r\n            <input v-model=\"owner.email\" type=\"email\" class=\"form-control\" id=\"modalEmail\" placeholder=\"E-mail\">\r\n            <label for=\"modalEmail\">E-mail</label>\r\n          </div>\r\n          <div class=\"form-floating mb-3\">\r\n            <input v-model=\"owner.address\" type=\"text\" class=\"form-control\" id=\"modalAddress\" placeholder=\"Address\">\r\n            <label for=\"modalAddress\">Address</label>\r\n          </div>\r\n          <div class=\"form-floating mb-3\">\r\n            <input v-model=\"owner.city\" type=\"text\" class=\"form-control\" id=\"modalCity\" placeholder=\"Place\">\r\n            <label for=\"modalCity\">Place</label>\r\n          </div>\r\n          <div class=\"form-floating mb-3\">\r\n            <country-select v-model=\"owner.country\" class=\"form-control\" id=\"modalCountry\" :usei18n=\"false\" :autocomplete=\"true\"  :countryName=\"true\"/>\r\n            <label for=\"modalCountry\">Country</label>\r\n          </div>\r\n          <div class=\"form-floating mb-3\">\r\n            <vue-tel-input id=\"phoneNumInput\" class=\"form-control\" v-model=\"phoneNum\" @validate=\"telValidate\"></vue-tel-input>\r\n            <label for=\"phoneNumInput\">Phone Number</label>\r\n          </div>\r\n        </div>\r\n        <div class=\"modal-footer\">\r\n          <button type=\"button\" class=\"custom-btn button-primary\" data-bs-dismiss=\"modal\">Close</button>\r\n          <button type=\"button\" @click=\"saveInfoEdit\" class=\"custom-btn button-primary\" data-bs-dismiss=\"modal\">Save Changes</button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport {onMounted, ref} from \"vue\";\r\nimport {useRouter} from \"vue-router\";\r\nimport axios from \"axios\";\r\n\r\nexport default {\r\n  name: \"OwnerInfo\",\r\n  setup() {\r\n    const router = useRouter();\r\n    // const root = getCurrentInstance();\r\n\r\n    let entityTypeInfo = ref({\r\n      urlPart: \"\"\r\n    });\r\n\r\n    let owner = ref({\r\n      id: null,\r\n      email: null,\r\n      username: null,\r\n      firstName: null,\r\n      lastName: null,\r\n      address: null,\r\n      city: null,\r\n      country: null,\r\n      phoneNum: null,\r\n      penalties: null,\r\n      accountType: null\r\n    });\r\n    let phoneNum = ref(null);\r\n    let validatedPhoneNum = ref(\"\")\r\n    let picture = ref(\"\");\r\n    let page = ref(\"homePage\");\r\n\r\n    onMounted(() => {\r\n      axios\r\n          .get(\"/api/users/loggedUser\",\r\n              { headers: { \"Authorization\" : `Bearer ${localStorage.getItem(\"jwt\")}`}})\r\n          .then(response => {\r\n            owner.value = response.data;\r\n\r\n            if(response.data.accountType === \"VH_OWNER\") {\r\n              entityTypeInfo.value = {\r\n                urlPart: \"vacationHouseOwners\"\r\n              };\r\n\r\n            } else if (response.data.accountType === \"SH_OWNER\") {\r\n              entityTypeInfo.value = {\r\n                urlPart: \"shipOwners\"\r\n              };\r\n\r\n              // else if INSTRUCTOR, ADMIN\r\n\r\n            } else {\r\n              router.push({name: \"homePage\"});\r\n            }\r\n          })\r\n          .catch(error => {\r\n            console.log(error.response);\r\n            // root.accessToken = null;\r\n            // localStorage.setItem(\"jwt\", null);\r\n            // router.push(\"/loginPage\");\r\n          });\r\n      axios\r\n          .get(\"/api/users/loggedUser/picture\",\r\n              { headers: {\"Authorization\" : `Bearer ${localStorage.getItem(\"jwt\")}`}})\r\n          .then(response => (picture.value = response.data))\r\n          .catch((error) => {\r\n            console.log(error.response);\r\n          });\r\n    });\r\n\r\n    function telValidate(phoneNumber) {\r\n      if (phoneNumber.valid) {\r\n        validatedPhoneNum.value = phoneNumber.number;\r\n      } else {\r\n        validatedPhoneNum.value = '';\r\n      }\r\n    }\r\n\r\n    function saveInfoEdit(){\r\n      if (validatedPhoneNum.value !== \"\")\r\n        owner.value.phoneNum = validatedPhoneNum.value;\r\n\r\n      axios\r\n          .put(`/api/${entityTypeInfo.value.urlPart}/${owner.value.id}`, owner.value,\r\n              { headers: {\"Authorization\" : `Bearer ${localStorage.getItem(\"jwt\")}`} })\r\n          .then(response => {\r\n            owner.value = response.data;\r\n            console.log(\"Info updated\");\r\n          })\r\n          .catch(error => {\r\n            console.log(error.response);\r\n          });\r\n    }\r\n\r\n    return {\r\n      owner,\r\n      phoneNum,\r\n      picture,\r\n      page,\r\n      telValidate,\r\n      saveInfoEdit\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n\r\n.main-description {\r\n  display:flex;\r\n  margin-top: 17px;\r\n  padding: 0;\r\n}\r\n\r\n.inner-description {\r\n  margin-right: 50px;\r\n  float: left;\r\n  width: 65%;\r\n  overflow: hidden;\r\n}\r\n\r\n.picture-container {\r\n  float: left;\r\n  width: 11em;\r\n}\r\n\r\n.picture {\r\n  border: 2px solid #00587a;\r\n  width: 11em;\r\n  height: 11em;\r\n  overflow: hidden;\r\n}\r\n\r\n.modal-button-div {\r\n  float: left;\r\n}\r\n\r\n.modal-button-div button {\r\n  width: 11em;\r\n}\r\n\r\n</style>"]},"metadata":{},"sourceType":"module"}