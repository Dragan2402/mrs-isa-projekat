{"ast":null,"code":"import { computed, ref, onMounted } from \"vue\";\nimport axios from \"axios\";\nimport { useRouter } from \"vue-router\";\nexport default {\n  name: \"OwnerHome\",\n\n  setup() {\n    const router = useRouter();\n    let entityTypeInfo = ref({\n      name: \"\",\n      urlPart: \"\",\n      routeName: \"\"\n    });\n    let entities = ref([{}]);\n    let filter = ref(\"\");\n    let availabilityInterval = ref(null);\n    let sortType = ref(0);\n    let hasReservations = ref();\n    let range = ref({\n      start: new Date(),\n      end: new Date()\n    }); // let bars = ref([]);\n    // let takenDatesPoppers = ref([]);\n    // let minDate = ref(null);\n    // let maxDate = ref(null);\n\n    const filteredEntities = computed(() => {\n      return entities.value.filter(row => {\n        return includes(row);\n      }).sort((a, b) => {\n        return sort(a, b);\n      });\n    }); // const attributes = computed(() => {\n    //   return [\n    //     ...bars.value,\n    //     // Attributes for todos\n    //     ...takenDatesPoppers.value.map(todo => ({\n    //       dates: todo.dates,\n    //       dot: {\n    //         color: todo.color,\n    //         class: todo.isComplete ? 'opacity-75' : '',\n    //       },\n    //       popover: {\n    //         label: todo.description,\n    //       },\n    //       customData: todo,\n    //     })),\n    //   ];\n    // })\n\n    onMounted(() => {\n      axios.get(\"/api/users/loggedUser\", {\n        headers: {\n          \"Authorization\": `Bearer ${localStorage.getItem(\"jwt\")}`\n        }\n      }).then(response => {\n        if (response.data.accountType === \"VH_OWNER\") {\n          entityTypeInfo.value = {\n            name: \"vacation house\",\n            urlPart: \"vacationHouses/loggedVacationHouseOwner\",\n            routeName: \"vacationHouseProfile\"\n          };\n        } else if (response.data.accountType === \"SH_OWNER\") {\n          entityTypeInfo.value = {\n            name: \"ship\",\n            urlPart: \"ships/loggedShipOwner\",\n            routeName: \"shipProfile\"\n          }; // else if INSTRUCTOR, ADMIN\n        } else {\n          router.push({\n            name: \"homePage\"\n          });\n        }\n\n        loadData();\n      }).catch(error => {\n        console.log(`OwnerHome catch users/loggedUser: ${error.response}`); // root.accessToken = null;\n        // localStorage.setItem(\"jwt\", null);\n        // router.push(\"/loginPage\");\n      });\n    });\n\n    function loadData() {\n      console.log(\"loadData:\");\n      console.log(entityTypeInfo.value);\n      axios.get(`api/${entityTypeInfo.value.urlPart}/all`, {\n        headers: {\n          \"Authorization\": `Bearer ${localStorage.getItem(\"jwt\")}`\n        }\n      }).then(response => {\n        entities.value = response.data;\n        entities.value.forEach(entity => {\n          entity.availabilityInterval = {\n            start: null,\n            end: null\n          };\n          entity.availabilityInterval.start = stringToDateTime(entity.availableFrom);\n          entity.availabilityInterval.end = stringToDateTime(entity.availableTo);\n          entity.fromDate = entity.availabilityInterval.start;\n        });\n      }).catch(error => {\n        console.log(error.response);\n      });\n    }\n\n    function entityHasReservations(id) {\n      axios.get(`api/${entityTypeInfo.value.urlPart}/${id}/hasReservations`, {\n        headers: {\n          \"Authorization\": `Bearer ${localStorage.getItem(\"jwt\")}`\n        }\n      }).then(response => {\n        hasReservations.value = response.data;\n      });\n    }\n\n    function updateEntity(entity) {\n      entity.availableFrom = dateTimeToString(entity.availabilityInterval.start);\n      entity.availableTo = dateTimeToString(entity.availabilityInterval.end);\n      axios.put(`api/${entityTypeInfo.value.urlPart}/${entity.id}`, entity, {\n        headers: {\n          \"Authorization\": `Bearer ${localStorage.getItem(\"jwt\")}`\n        }\n      }).then(response => {\n        console.log(response.data);\n        loadData();\n      }).catch(error => {\n        console.log(error.response);\n      });\n    }\n\n    function deleteEntity(entityId) {\n      axios.delete(`/api/${entityTypeInfo.value.urlPart}/${entityId}`, {\n        headers: {\n          \"Authorization\": `Bearer ${localStorage.getItem(\"jwt\")}`\n        }\n      }).then(response => {\n        console.log(response.data);\n        loadData();\n      }).catch(error => {\n        console.log(error.response);\n      });\n    }\n\n    function openEntityProfile(entityId) {\n      router.push({\n        name: entityTypeInfo.value.routeName,\n        params: {\n          id: entityId\n        }\n      });\n    }\n\n    function stringToDateTime(s) {\n      let tokens = s.split(\" \");\n      let date = tokens[0];\n      let time = tokens[1];\n      tokens = date.split(\".\");\n      let day = parseInt(tokens[0]);\n      let month = parseInt(tokens[1]) - 1;\n      let year = parseInt(tokens[2]);\n      tokens = time.split(\":\");\n      let hour = parseInt(tokens[0]);\n      let minute = parseInt(tokens[1]);\n      return new Date(year, month, day, hour, minute);\n    }\n\n    function dateTimeToString(dt) {\n      let day = (\"0\" + dt.getDate()).slice(-2);\n      let month = (\"0\" + (dt.getMonth() + 1)).slice(-2);\n      let year = dt.getFullYear();\n      let hour = (\"0\" + dt.getHours()).slice(-2);\n      let minute = (\"0\" + dt.getMinutes()).slice(-2);\n      return `${day}.${month}.${year} ${hour}:${minute}`;\n    }\n\n    function dateFromLocal(dateString) {\n      if (dateString == null) {\n        return new Date();\n      }\n\n      const parts = dateString.split(\" \");\n\n      if (parts.length !== 2) {\n        return new Date();\n      }\n\n      const dateParts = parts[0].split(\".\");\n\n      if (dateParts.length !== 3) {\n        return new Date();\n      }\n\n      const hourParts = parts[1].split(\":\");\n\n      if (hourParts.length !== 2) {\n        return new Date();\n      }\n\n      const day = dateParts[0];\n      const month = dateParts[1];\n      const year = dateParts[2];\n      const hours = hourParts[0];\n      const minutes = hourParts[1]; // new Date(year, month, day, hours, minutes, seconds, milliseconds)\n      // const date = new Date(year,month-1,day,hours,minutes);\n\n      return new Date(year, month - 1, day, hours, minutes);\n    }\n\n    function includes(row) {\n      if (row.name === undefined || row.address === undefined || row.priceList === undefined || filter.value === undefined) return false;\n      const name = row.name.toString().toLowerCase();\n      const address = row.address.toString().toLowerCase();\n      const price = row.priceList.toString().toLowerCase();\n      const searchTerm = filter.value.toLowerCase();\n      const availableFrom = dateFromLocal(row.availableFrom);\n      const availableTo = dateFromLocal(row.availableTo);\n      let dateInInterval = false;\n      let dateFilterOn = false;\n\n      if (availabilityInterval.value != null) {\n        dateFilterOn = true;\n        let fromFilter = availabilityInterval.value.start;\n        let toFilter = availabilityInterval.value.end;\n\n        if (fromFilter == null) {\n          fromFilter = new Date();\n        }\n\n        if (toFilter == null) {\n          toFilter = new Date();\n        }\n\n        dateInInterval = availableFrom <= fromFilter && availableTo >= toFilter;\n      }\n\n      if (dateFilterOn && dateInInterval) {\n        return name.includes(searchTerm) || address.includes(searchTerm) || price.includes(searchTerm);\n      } else if (dateFilterOn && !dateInInterval) {\n        return false;\n      }\n\n      return name.includes(searchTerm) || address.includes(searchTerm) || price.includes(searchTerm);\n    }\n\n    function sort(a, b) {\n      if (sortType.value === 0) {\n        let fa = a.name.toLowerCase(),\n            fb = b.name.toLowerCase();\n\n        if (fa < fb) {\n          return -1;\n        }\n\n        if (fa > fb) {\n          return 1;\n        }\n\n        return 0;\n      } else if (sortType.value === 1) {\n        let fa = a.name.toLowerCase(),\n            fb = b.name.toLowerCase();\n\n        if (fa > fb) {\n          return -1;\n        }\n\n        if (fa < fb) {\n          return 1;\n        }\n\n        return 0;\n      }\n\n      if (sortType.value === 2) {\n        let fa = parseInt(a.priceList),\n            fb = parseInt(b.priceList);\n\n        if (fa > fb) {\n          return -1;\n        }\n\n        if (fa < fb) {\n          return 1;\n        }\n\n        return 0;\n      } else if (sortType.value === 3) {\n        let fa = parseInt(a.priceList),\n            fb = parseInt(b.priceList);\n\n        if (fa < fb) {\n          return -1;\n        }\n\n        if (fa > fb) {\n          return 1;\n        }\n\n        return 0;\n      }\n    }\n\n    return {\n      entityTypeInfo,\n      filter,\n      sortType,\n      availabilityInterval,\n      filteredEntities,\n      hasReservations,\n      range,\n      // attributes,\n      // minDate,\n      // maxDate,\n      entityHasReservations,\n      updateEntity,\n      deleteEntity,\n      openEntityProfile\n    };\n  }\n\n};","map":{"version":3,"mappings":"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","names":["computed","ref","onMounted","axios","useRouter","name","setup","router","entityTypeInfo","urlPart","routeName","entities","filter","availabilityInterval","sortType","hasReservations","range","start","Date","end","filteredEntities","value","row","includes","sort","a","b","get","headers","localStorage","getItem","then","response","data","accountType","push","loadData","catch","error","console","log","forEach","entity","stringToDateTime","availableFrom","availableTo","fromDate","entityHasReservations","id","updateEntity","dateTimeToString","put","deleteEntity","entityId","delete","openEntityProfile","params","s","tokens","split","date","time","day","parseInt","month","year","hour","minute","dt","getDate","slice","getMonth","getFullYear","getHours","getMinutes","dateFromLocal","dateString","parts","length","dateParts","hourParts","hours","minutes","undefined","address","priceList","toString","toLowerCase","price","searchTerm","dateInInterval","dateFilterOn","fromFilter","toFilter","fa","fb"],"sourceRoot":"","sources":["C:\\Users\\draga\\OneDrive\\Dokumenti\\MRS-ISA-PROJEKAT\\mrs-isa-projekat\\projekat\\src\\frontend\\src\\components\\user_profiles\\owner_profiles\\OwnerHome.vue"],"sourcesContent":["<template>\r\n\r\n\r\n\r\n  <div class=\"left-bar\">\r\n    <h5 style=\"color: white; font-weight: bold\">Search</h5>\r\n    <div class=\"left-bar-text\">Destination name:</div>\r\n    <div>\r\n      <input class=\"input-group-text\" type=\"text\" placeholder=\"Filter by name, address...\" v-model=\"filter\"/>\r\n    </div>\r\n    <div class=\"left-bar-text\">Date:</div>\r\n<!--    <Datepicker v-model=\"availabilityInterval\" :format=\"formatRange\" range clearable/>-->\r\n    <v-date-picker v-model=\"availabilityInterval\" is-range>\r\n      <template v-slot=\"{ inputValue, inputEvents }\">\r\n        <div class=\"flex justify-center items-center\">\r\n          <input\r\n              :value=\"inputValue.start\"\r\n              v-on=\"inputEvents.start\"\r\n              class=\"border px-2 py-1 w-32 rounded focus:outline-none focus:border-indigo-300 mb-1 w-100\"\r\n          />\r\n          <input\r\n              :value=\"inputValue.end\"\r\n              v-on=\"inputEvents.end\"\r\n              class=\"border px-2 py-1 w-32 rounded focus:outline-none focus:border-indigo-300 w-100\"\r\n          />\r\n        </div>\r\n      </template>\r\n    </v-date-picker>\r\n    <div class=\"left-bar-text\">Sort by:</div>\r\n    <div class=\"sort\">\r\n      <select class=\"form-select\" v-model=\"sortType\" name=\"example\">\r\n        <option value=0>Name descending</option>\r\n        <option value=1>Name ascending</option>\r\n        <option value=2>Price descending</option>\r\n        <option value=3>Price ascending</option>\r\n      </select>\r\n    </div>\r\n  </div>\r\n\r\n\r\n\r\n  <div class=\"home-entities-div\">\r\n    <div class=\"home-list-entities\" v-for=\"entity in filteredEntities\" :key=\"entity.id\">\r\n      <div class=\"home-entity-picture\"><img v-bind:src=\"'data:image/jpeg;base64,' + entity.img\" v-bind:alt=\"entity.id\" style=\"width: 200px; height: 150px; cursor: pointer\"></div>\r\n      <div class=\"home-entity-content\">\r\n        <h4 style=\"font-weight: bold; cursor: pointer\">{{ entity.name }}</h4>\r\n        <div class=\"home-entity-description\">\r\n          <i class=\"bi bi-geo-alt-fill\"></i> {{ entity.address }}\r\n        </div>\r\n        <vue3-star-ratings class=\"star-ratings\" v-model=\"entity.rating\" starSize=\"15\" :showControl=false :disableClick=true :step=0 />\r\n        <span style=\"color: #585858;\">({{entity.reviewsNumber}})</span>\r\n      </div>\r\n      <div class=\"home-entity-price h-100 d-flex\">\r\n        <div class=\"align-self-center\">\r\n          <button type=\"button\" class=\"custom-btn button-primary d-block w-100\" @click=\"openEntityProfile(entity.id)\">Open Profile</button>\r\n          <button type=\"button\" class=\"custom-btn button-primary d-block w-100\" @click=\"entityHasReservations(entity.id)\" data-bs-toggle=\"modal\" data-bs-target=\"#updateModal\">Update</button>\r\n          <button type=\"button\" class=\"custom-btn button-primary d-block w-100\" @click=\"entityHasReservations(entity.id)\" data-bs-toggle=\"modal\" data-bs-target=\"#deleteModal\">Delete</button>\r\n        </div>\r\n      </div>\r\n\r\n      <div class=\"modal fade\" id=\"updateModal\" tabindex=\"-1\" aria-hidden=\"true\">\r\n        <div class=\"modal-dialog modal-dialog-centered modal-lg\">\r\n          <div class=\"modal-content\">\r\n            <div class=\"modal-header\" v-if=\"hasReservations\">\r\n              <h5 class=\"modal-title mx-auto\">This {{entityTypeInfo.name}} is currently reserved</h5>\r\n            </div>\r\n            <div class=\"modal-body\" v-if=\"!hasReservations\">\r\n              <div class=\"form-floating mb-3\">\r\n                <input v-model=\"entity.name\" type=\"text\" class=\"form-control\" id=\"floatName\" placeholder=\"Title\">\r\n                <label for=\"floatName\">Title</label>\r\n              </div>\r\n              <div class=\"form-floating mb-3\">\r\n                <input v-model=\"entity.address\" type=\"text\" class=\"form-control\" id=\"floatAddress\" placeholder=\"Address\">\r\n                <label for=\"floatAddress\">Address</label>\r\n              </div>\r\n              <div class=\"form-floating mb-3\">\r\n                <textarea style=\"height: 100px\" v-model=\"entity.promoDescription\" type=\"text\" class=\"form-control\" id=\"floatPromoDescription\" placeholder=\"Description\"></textarea>\r\n                <label for=\"floatPromoDescription\">Description</label>\r\n              </div>\r\n              <div class=\"form-floating mb-3\">\r\n                <textarea style=\"height: 100px\" v-model=\"entity.behaviourRules\" type=\"text\" class=\"form-control\" id=\"floatBehaviourRules\" placeholder=\"Behaviour rules\"></textarea>\r\n                <label for=\"floatBehaviourRules\">Behaviour rules</label>\r\n              </div>\r\n              <div class=\"form-floating mb-3\">\r\n                <input v-model=\"entity.priceList\" type=\"text\" class=\"form-control\" id=\"floatPriceList\" placeholder=\"Price\">\r\n                <label for=\"floatPriceList\">Price</label>\r\n              </div>\r\n              <div class=\"form-floating mb-3\">\r\n                <textarea style=\"height: 100px\" v-model=\"entity.additionalInfo\" type=\"text\" class=\"form-control\" id=\"floatAdditionalInfo\" placeholder=\"Additional info\"></textarea>\r\n                <label for=\"floatAdditionalInfo\">Additional info</label>\r\n              </div>\r\n              <div class=\"form-floating mb-3\">\r\n                <input v-model=\"entity.cancellationConditions\" type=\"text\" class=\"form-control\" id=\"floatCancellationConditions\" placeholder=\"Cancellation conditions\">\r\n                <label for=\"floatCancellationConditions\">Cancellation conditions</label>\r\n              </div>\r\n\r\n\r\n              <!-- Vacation House specific attributes -->\r\n              <div v-if=\"entityTypeInfo.name==='vacation house'\" class=\"form-floating mb-3\">\r\n                <input v-model=\"entity.roomsQuantity\" type=\"text\" class=\"form-control\" id=\"floatRoomsQuantity\" placeholder=\"Rooms quantity\">\r\n                <label for=\"floatRoomsQuantity\">Rooms quantity</label>\r\n              </div>\r\n              <div v-if=\"entityTypeInfo.name==='vacation house'\" class=\"form-floating mb-3\">\r\n                <input v-model=\"entity.bedsPerRoom\" type=\"text\" class=\"form-control\" id=\"floatBedsPerRoom\" placeholder=\"Beds per room\">\r\n                <label for=\"floatBedsPerRoom\">Beds per room</label>\r\n              </div>\r\n\r\n\r\n\r\n              <!-- Ship specific attributes -->\r\n              <div v-if=\"entityTypeInfo.name==='ship'\" class=\"form-floating mb-3\">\r\n                <input v-model=\"entity.type\" type=\"text\" class=\"form-control\" id=\"floatType\" placeholder=\"Type\">\r\n                <label for=\"floatType\">Type</label>\r\n              </div>\r\n              <div v-if=\"entityTypeInfo.name==='ship'\" class=\"form-floating mb-3\">\r\n                <input v-model=\"entity.length\" type=\"text\" class=\"form-control\" id=\"floatLength\" placeholder=\"Length\">\r\n                <label for=\"floatLength\">Length</label>\r\n              </div>\r\n              <div v-if=\"entityTypeInfo.name==='ship'\" class=\"form-floating mb-3\">\r\n                <input v-model=\"entity.engineNumber\" type=\"text\" class=\"form-control\" id=\"floatEngineNumber\" placeholder=\"Engine number\">\r\n                <label for=\"floatEngineNumber\">Engine number</label>\r\n              </div>\r\n              <div v-if=\"entityTypeInfo.name==='ship'\" class=\"form-floating mb-3\">\r\n                <input v-model=\"entity.enginePower\" type=\"text\" class=\"form-control\" id=\"floatEnginePower\" placeholder=\"Engine power\">\r\n                <label for=\"floatEnginePower\">Engine power</label>\r\n              </div>\r\n              <div v-if=\"entityTypeInfo.name==='ship'\" class=\"form-floating mb-3\">\r\n                <input v-model=\"entity.topSpeed\" type=\"text\" class=\"form-control\" id=\"floatTopSpeed\" placeholder=\"Top speed\">\r\n                <label for=\"floatTopSpeed\">Top speed</label>\r\n              </div>\r\n              <div v-if=\"entityTypeInfo.name==='ship'\" class=\"form-floating mb-3\">\r\n                <input v-model=\"entity.clientLimit\" type=\"text\" class=\"form-control\" id=\"floatClientLimit\" placeholder=\"Client limit\">\r\n                <label for=\"floatClientLimit\">Client limit</label>\r\n              </div>\r\n\r\n\r\n\r\n              <!-- Fishing Class specific attributes -->\r\n\r\n\r\n\r\n              <v-date-picker v-model=\"entity.availabilityInterval\" :min-date=\"new Date()\" :from-date=\"entity.fromDate\" mode=\"dateTime\" is-range is-expanded is24hr ></v-date-picker>\r\n            </div>\r\n            <div class=\"modal-footer\">\r\n              <button type=\"button\" class=\"custom-btn button-primary\" data-bs-dismiss=\"modal\">Close</button>\r\n              <button v-if=\"!hasReservations\" type=\"button\" @click=\"updateEntity(entity)\" class=\"custom-btn button-primary\" data-bs-dismiss=\"modal\">Update</button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      <div class=\"modal fade\" id=\"deleteModal\" tabindex=\"-1\" aria-hidden=\"true\">\r\n        <div class=\"modal-dialog modal-dialog-centered modal-lg\">\r\n          <div class=\"modal-content\">\r\n            <div class=\"modal-header\">\r\n              <h5 class=\"modal-title mx-auto\" v-if=\"hasReservations\">This {{entityTypeInfo.name}} is currently reserved</h5>\r\n              <h5 class=\"modal-title mx-auto\" v-if=\"!hasReservations\">Are you sure?</h5>\r\n            </div>\r\n            <div class=\"modal-footer\">\r\n              <button type=\"button\" class=\"custom-btn button-close\" data-bs-dismiss=\"modal\">Cancel</button>\r\n              <button v-if=\"!hasReservations\" type=\"button\" class=\"custom-btn button-primary\" @click=\"deleteEntity(entity.id)\" data-bs-dismiss=\"modal\">Delete</button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n    </div>\r\n  </div>\r\n\r\n\r\n</template>\r\n\r\n<script>\r\nimport {computed, ref, onMounted} from \"vue\";\r\nimport axios from \"axios\";\r\nimport {useRouter} from \"vue-router\";\r\n\r\nexport default {\r\n  name: \"OwnerHome\",\r\n  setup() {\r\n    const router = useRouter();\r\n\r\n    let entityTypeInfo = ref({\r\n      name: \"\",\r\n      urlPart: \"\",\r\n      routeName: \"\"\r\n    });\r\n\r\n    let entities  = ref([{}]);\r\n    let filter = ref(\"\");\r\n    let availabilityInterval = ref(null);\r\n    let sortType = ref(0);\r\n    let hasReservations = ref();\r\n\r\n    let range = ref({\r\n      start: new Date(),\r\n      end: new Date()\r\n    });\r\n    // let bars = ref([]);\r\n    // let takenDatesPoppers = ref([]);\r\n    // let minDate = ref(null);\r\n    // let maxDate = ref(null);\r\n\r\n    const filteredEntities = computed(() => {\r\n      return entities.value\r\n          .filter(row => {\r\n            return includes(row);\r\n          })\r\n          .sort((a, b) => {\r\n            return sort(a, b);\r\n          })\r\n    })\r\n\r\n    // const attributes = computed(() => {\r\n    //   return [\r\n    //     ...bars.value,\r\n    //     // Attributes for todos\r\n    //     ...takenDatesPoppers.value.map(todo => ({\r\n    //       dates: todo.dates,\r\n    //       dot: {\r\n    //         color: todo.color,\r\n    //         class: todo.isComplete ? 'opacity-75' : '',\r\n    //       },\r\n    //       popover: {\r\n    //         label: todo.description,\r\n    //       },\r\n    //       customData: todo,\r\n    //     })),\r\n    //   ];\r\n    // })\r\n\r\n    onMounted(() => {\r\n      axios\r\n          .get(\"/api/users/loggedUser\",\r\n          { headers: {\"Authorization\" : `Bearer ${localStorage.getItem(\"jwt\")}`} })\r\n          .then(response => {\r\n            if(response.data.accountType === \"VH_OWNER\") {\r\n              entityTypeInfo.value = {\r\n                name: \"vacation house\",\r\n                urlPart: \"vacationHouses/loggedVacationHouseOwner\",\r\n                routeName: \"vacationHouseProfile\"\r\n              };\r\n\r\n            } else if (response.data.accountType === \"SH_OWNER\") {\r\n              entityTypeInfo.value = {\r\n                name: \"ship\",\r\n                urlPart: \"ships/loggedShipOwner\",\r\n                routeName: \"shipProfile\"\r\n              };\r\n\r\n            // else if INSTRUCTOR, ADMIN\r\n\r\n            } else {\r\n              router.push({name: \"homePage\"});\r\n            }\r\n\r\n            loadData();\r\n          })\r\n          .catch(error => {\r\n            console.log(`OwnerHome catch users/loggedUser: ${error.response}`);\r\n            // root.accessToken = null;\r\n            // localStorage.setItem(\"jwt\", null);\r\n            // router.push(\"/loginPage\");\r\n          });\r\n    });\r\n\r\n    function loadData() {\r\n      console.log(\"loadData:\")\r\n      console.log(entityTypeInfo.value);\r\n      axios\r\n          .get(`api/${entityTypeInfo.value.urlPart}/all`,\r\n              { headers: {\"Authorization\" : `Bearer ${localStorage.getItem(\"jwt\")}`} })\r\n          .then(response => {\r\n            entities.value = response.data;\r\n            entities.value.forEach(entity => {\r\n              entity.availabilityInterval = {\r\n                start: null,\r\n                end: null\r\n              }\r\n              entity.availabilityInterval.start = stringToDateTime(entity.availableFrom);\r\n              entity.availabilityInterval.end = stringToDateTime(entity.availableTo);\r\n              entity.fromDate = entity.availabilityInterval.start;\r\n            })\r\n          })\r\n          .catch(error => {\r\n            console.log(error.response);\r\n          });\r\n    }\r\n\r\n    function entityHasReservations(id) {\r\n      axios\r\n          .get(`api/${entityTypeInfo.value.urlPart}/${id}/hasReservations`,\r\n              { headers: {\"Authorization\" : `Bearer ${localStorage.getItem(\"jwt\")}`} })\r\n          .then(response => {\r\n            hasReservations.value = response.data;\r\n          });\r\n    }\r\n\r\n    function updateEntity(entity) {\r\n      entity.availableFrom = dateTimeToString(entity.availabilityInterval.start);\r\n      entity.availableTo = dateTimeToString(entity.availabilityInterval.end);\r\n\r\n      axios\r\n          .put(`api/${entityTypeInfo.value.urlPart}/${entity.id}`, entity,\r\n              { headers: {\"Authorization\" : `Bearer ${localStorage.getItem(\"jwt\")}`} })\r\n          .then(response => {\r\n            console.log(response.data);\r\n            loadData();\r\n          })\r\n          .catch(error => {\r\n            console.log(error.response);\r\n          });\r\n    }\r\n\r\n    function deleteEntity(entityId) {\r\n      axios\r\n          .delete(`/api/${entityTypeInfo.value.urlPart}/${entityId}`,\r\n              { headers: {\"Authorization\" : `Bearer ${localStorage.getItem(\"jwt\")}`} })\r\n          .then(response => {\r\n            console.log(response.data);\r\n            loadData();\r\n          })\r\n          .catch(error => {\r\n            console.log(error.response);\r\n          });\r\n    }\r\n\r\n    function openEntityProfile(entityId) {\r\n      router.push({\r\n        name: entityTypeInfo.value.routeName,\r\n        params: {\r\n          id: entityId\r\n        }\r\n      });\r\n    }\r\n\r\n    function stringToDateTime(s) {\r\n      let tokens = s.split(\" \");\r\n      let date = tokens[0];\r\n      let time = tokens[1];\r\n\r\n      tokens = date.split(\".\");\r\n      let day = parseInt(tokens[0]);\r\n      let month = parseInt(tokens[1]) - 1;\r\n      let year = parseInt(tokens[2]);\r\n\r\n      tokens = time.split(\":\");\r\n      let hour = parseInt(tokens[0]);\r\n      let minute = parseInt(tokens[1]);\r\n\r\n      return new Date(year, month, day, hour, minute);\r\n    }\r\n\r\n    function dateTimeToString(dt) {\r\n      let day = (\"0\" + dt.getDate()).slice(-2);\r\n      let month = (\"0\" + (dt.getMonth() + 1)).slice(-2);\r\n      let year = dt.getFullYear();\r\n      let hour = (\"0\" + dt.getHours()).slice(-2);\r\n      let minute = (\"0\" + dt.getMinutes()).slice(-2);\r\n      return `${day}.${month}.${year} ${hour}:${minute}`;\r\n    }\r\n\r\n    function dateFromLocal(dateString) {\r\n      if(dateString == null){\r\n        return new Date();\r\n      }\r\n\r\n      const parts = dateString.split(\" \");\r\n      if(parts.length !== 2) {\r\n        return new Date();\r\n      }\r\n\r\n      const dateParts = parts[0].split(\".\");\r\n      if( dateParts.length !== 3){\r\n        return new Date();\r\n      }\r\n\r\n      const hourParts = parts[1].split(\":\");\r\n      if( hourParts.length !== 2){\r\n        return new Date();\r\n      }\r\n\r\n      const day = dateParts[0];\r\n      const month = dateParts[1];\r\n      const year = dateParts[2];\r\n      const hours = hourParts[0];\r\n      const minutes = hourParts[1];\r\n      // new Date(year, month, day, hours, minutes, seconds, milliseconds)\r\n      // const date = new Date(year,month-1,day,hours,minutes);\r\n      return new Date(year,month-1,day,hours,minutes);\r\n    }\r\n\r\n    function includes(row) {\r\n      if(row.name === undefined || row.address === undefined || row.priceList === undefined || filter.value === undefined)\r\n        return false;\r\n\r\n      const name = row.name.toString().toLowerCase();\r\n      const address = row.address.toString().toLowerCase();\r\n      const price = row.priceList.toString().toLowerCase();\r\n      const searchTerm = filter.value.toLowerCase();\r\n\r\n      const availableFrom = dateFromLocal(row.availableFrom);\r\n      const availableTo= dateFromLocal(row.availableTo);\r\n      let dateInInterval = false;\r\n      let dateFilterOn = false;\r\n\r\n      if(availabilityInterval.value != null){\r\n        dateFilterOn = true;\r\n        let fromFilter = availabilityInterval.value.start\r\n        let toFilter = availabilityInterval.value.end\r\n        if(fromFilter == null){\r\n          fromFilter = new Date();\r\n        }\r\n        if(toFilter == null){\r\n          toFilter = new Date();\r\n        }\r\n        dateInInterval = availableFrom <= fromFilter && availableTo >= toFilter;\r\n      }\r\n\r\n      if(dateFilterOn && dateInInterval) {\r\n        return (name.includes(searchTerm) || address.includes(searchTerm) || price.includes(searchTerm))\r\n      }\r\n      else if(dateFilterOn && !dateInInterval) {\r\n        return false;\r\n      }\r\n      return (name.includes(searchTerm) || address.includes(searchTerm) || price.includes(searchTerm))\r\n    }\r\n\r\n    function sort(a, b) {\r\n      if(sortType.value === 0) {\r\n        let fa = a.name.toLowerCase(), fb = b.name.toLowerCase();\r\n        if (fa < fb) {\r\n          return -1\r\n        }\r\n        if (fa > fb) {\r\n          return 1\r\n        }\r\n        return 0\r\n      }\r\n      else if(sortType.value === 1) {\r\n        let fa = a.name.toLowerCase(), fb = b.name.toLowerCase();\r\n        if (fa > fb) {\r\n          return -1\r\n        }\r\n        if (fa < fb) {\r\n          return 1\r\n        }\r\n        return 0\r\n      }\r\n      if(sortType.value === 2) {\r\n        let fa = parseInt(a.priceList), fb = parseInt(b.priceList)\r\n        if (fa > fb) {\r\n          return -1\r\n        }\r\n        if (fa < fb) {\r\n          return 1\r\n        }\r\n        return 0\r\n      }\r\n      else if (sortType.value === 3) {\r\n        let fa = parseInt(a.priceList), fb = parseInt(b.priceList);\r\n        if (fa < fb) {\r\n          return -1\r\n        }\r\n        if (fa > fb) {\r\n          return 1\r\n        }\r\n        return 0\r\n      }\r\n    }\r\n\r\n    return {\r\n      entityTypeInfo,\r\n      filter,\r\n      sortType,\r\n      availabilityInterval,\r\n      filteredEntities,\r\n      hasReservations,\r\n      range,\r\n      // attributes,\r\n      // minDate,\r\n      // maxDate,\r\n      entityHasReservations,\r\n      updateEntity,\r\n      deleteEntity,\r\n      openEntityProfile\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n\r\n</style>"]},"metadata":{},"sourceType":"module"}