{"ast":null,"code":"import axios from \"axios\";\nexport default {\n  name: \"ClientProfile\",\n\n  data() {\n    return {\n      user: {},\n      backUp: {},\n      selectedFile: null,\n      picture: null,\n      editing: false,\n      validNumber: '',\n      phoneNum: null,\n      oldPassword: \"\",\n      newPassword: \"\",\n      confirmPassword: \"\",\n      subscriptions: [],\n      text: \"\",\n      reservationsHistory: [],\n      selectedReservationHistory: {},\n      reservations: [],\n      filterR: \"\",\n      filterH: \"\",\n      ratingRE: 5,\n      commentRatingRE: \"\",\n      commentRatingRO: \"\",\n      ratingRO: 5,\n      sortTypeR: 0,\n      sortTypeH: 0,\n      commentReportRE: \"\",\n      commentReportRO: \"\"\n    };\n  },\n\n  mounted() {\n    axios.get(\"/api/clients/loggedClient\", {\n      headers: {\n        \"Authorization\": `Bearer ${localStorage.getItem(\"jwt\")}`\n      }\n    }).then(response => this.user = response.data).catch(errorP => {\n      if (errorP.response.status === 401) {\n        //this.$toast.error(\"Not Logged In\");\n        this.$root.accessToken = null;\n        localStorage.setItem(\"jwt\", null);\n        this.$router.push(\"/loginPage\");\n      }\n    });\n    axios.get(\"/api/users/loggedUser/picture\", {\n      headers: {\n        \"Authorization\": `Bearer ${localStorage.getItem(\"jwt\")}`\n      }\n    }).then(response => this.picture = response.data).catch(errorP => {\n      if (errorP.response.status === 401) {\n        //this.$toast.error(\"Not Logged In\");\n        this.$root.accessToken = null;\n        localStorage.setItem(\"jwt\", null);\n        this.$router.push(\"/loginPage\");\n      }\n    });\n    axios.get(\"/api/clients/subscriptions\", {\n      headers: {\n        \"Authorization\": `Bearer ${localStorage.getItem(\"jwt\")}`\n      }\n    }).then(response => this.subscriptions = response.data).catch(errorP => {\n      if (errorP.response.status === 401) {\n        //this.$toast.error(\"Not Logged In\");\n        this.$root.accessToken = null;\n        localStorage.setItem(\"jwt\", null);\n        this.$router.push(\"/loginPage\");\n      }\n    });\n    axios.get(\"/api/clients/loggedClient/reservations\", {\n      headers: {\n        \"Authorization\": `Bearer ${localStorage.getItem(\"jwt\")}`\n      }\n    }).then(response => this.reservations = response.data).catch(errorP => {\n      if (errorP.response.status === 401) {\n        //this.$toast.error(\"Not Logged In\");\n        this.$root.accessToken = null;\n        localStorage.setItem(\"jwt\", null);\n        this.$router.push(\"/loginPage\");\n      }\n    });\n    axios.get(\"/api/clients/loggedClient/reservationHistory\", {\n      headers: {\n        \"Authorization\": `Bearer ${localStorage.getItem(\"jwt\")}`\n      }\n    }).then(response => this.reservationsHistory = response.data).catch(errorP => {\n      if (errorP.response.status === 401) {\n        //this.$toast.error(\"Not Logged In\");\n        this.$root.accessToken = null;\n        localStorage.setItem(\"jwt\", null);\n        this.$router.push(\"/loginPage\");\n      }\n    });\n  },\n\n  computed: {\n    filteredReservationsHistory() {\n      return this.reservationsHistory.filter(row => {\n        return this.includesH(row);\n      }).sort((a, b) => {\n        return this.sort(a, b, this.sortTypeH);\n      });\n    },\n\n    filteredReservations() {\n      return this.reservations.filter(row => {\n        return this.includesH(row);\n      }).sort((a, b) => {\n        return this.sort(a, b, this.sortTypeR);\n      });\n    }\n\n  },\n  methods: {\n    toggleEdit() {\n      this.backUp = {\n        \"firstName\": this.user.firstName,\n        \"lastName\": this.user.lastName,\n        \"address\": this.user.address,\n        \"city\": this.user.city,\n        \"country\": this.user.country,\n        \"phoneNum\": this.user.phoneNum\n      };\n      this.editing = true;\n    },\n\n    changePassword() {\n      var passwordRegex = /^[0-9A-Za-z]+$/;\n\n      if (this.newPassword.length < 5 || this.newPassword.length > 20) {\n        this.$toast.error(\"Password must be between 5-20 characters\");\n        return;\n      }\n\n      if (!passwordRegex.test(this.newPassword)) {\n        this.$toast.error(\"Password must only contain letters and numbers\");\n        return;\n      }\n\n      if (!passwordRegex.test(this.oldPassword)) {\n        this.$toast.error(\"Password must only contain letters and numbers\");\n        return;\n      }\n\n      if (this.newPassword !== this.confirmPassword) {\n        this.$toast.error(\"Passwords must match\");\n        return;\n      }\n\n      const passwordChange = {\n        \"oldPassword\": this.oldPassword,\n        \"newPassword\": this.newPassword,\n        \"newPasswordConfirm\": this.confirmPassword\n      };\n      console.log(passwordChange);\n      axios.put(`/api/clients/changePassword`, passwordChange, {\n        headers: {\n          \"Authorization\": `Bearer ${localStorage.getItem(\"jwt\")}`\n        }\n      }).then(response => {\n        if (response.data == true) {\n          this.$root.accessToken = null;\n          this.$root.signedIn = false;\n          localStorage.setItem(\"jwt\", null);\n          window.location.href = 'http://localhost:3000/loginPage';\n        } else {\n          this.$toast.error(\"Error\");\n        }\n      });\n    },\n\n    sendDeleteRequest() {\n      if (this.text.length < 5) {\n        this.$toast.error(\"Provide a reason\");\n        return;\n      }\n\n      const request = {\n        \"id\": 0,\n        'submitterId': this.user.id,\n        'submitterUsername': this.user.username,\n        'text': this.text,\n        'type': 0\n      };\n      console.log(request);\n      axios.post(\"/api/users/submitRequest\", request, {\n        headers: {\n          \"Authorization\": `Bearer ${localStorage.getItem(\"jwt\")}`\n        }\n      }).then(response => {\n        if (response.data == true) {\n          this.$toast.success(\"Request Sent\");\n        } else {\n          this.$toast.error(\"Error\");\n        }\n      });\n    },\n\n    unsubscribe(subscription, index) {\n      axios.put(`/api/clients/unSubscribeDTO`, subscription, {\n        headers: {\n          \"Authorization\": `Bearer ${localStorage.getItem(\"jwt\")}`\n        }\n      }).then(response => {\n        if (response.data == true) {\n          this.$toast.success(\"Unsubscribed\");\n          this.subscriptions.splice(index, 1);\n        } else {\n          this.$toast.error(\"Error\");\n        }\n      });\n    },\n\n    saveEdit() {\n      var regExp = /^[A-Za-z]+$/;\n\n      if (this.user.firstName.length < 2 || this.user.firstName.length > 20) {\n        this.$toast.error(\"First name must be between 2-20 characters\");\n        return;\n      }\n\n      if (regExp.test(this.user.firstName) == false) {\n        this.$toast.error(\"First name must contain only letters\");\n        return;\n      }\n\n      this.user.firstName = this.user.firstName.charAt(0).toUpperCase() + this.user.firstName.slice(1);\n\n      if (this.user.lastName.length < 2 || this.user.lastName.length > 20) {\n        this.$toast.error(\"Last name must be between 2-20 characters\");\n        return;\n      }\n\n      if (regExp.test(this.user.lastName) == false) {\n        this.$toast.error(\"Last name must contain only letters\");\n        return;\n      }\n\n      this.user.lastName = this.user.lastName.charAt(0).toUpperCase() + this.user.lastName.slice(1);\n\n      if (this.user.address === '') {\n        this.$toast.error(\"Provide address\");\n        return;\n      }\n\n      if (this.user.city === '') {\n        this.$toast.error(\"Provide city name\");\n        return;\n      }\n\n      if (this.country == \"\") {\n        this.$toast.error(\"Provide country\");\n        return;\n      }\n\n      if (this.validNumber === '') {\n        this.$toast.error(\"Phone number invalid\");\n        return;\n      }\n\n      this.user.phoneNum = this.validNumber;\n      axios.post(\"/api/clients/loggedClient\", this.user, {\n        headers: {\n          \"Authorization\": `Bearer ${localStorage.getItem(\"jwt\")}`\n        }\n      }).then(response => this.user = response.data).then(this.toastMessage());\n      this.editing = false;\n    },\n\n    telValidate(phoneNum) {\n      if (phoneNum.valid) {\n        this.validNumber = phoneNum.number;\n      } else {\n        this.validNumber = '';\n      }\n    },\n\n    cancelEdit() {\n      this.user.firstName = this.backUp.firstName;\n      this.user.lastName = this.backUp.lastName;\n      this.user.address = this.backUp.address;\n      this.user.city = this.backUp.city;\n      this.user.country = this.backUp.country;\n      this.user.phoneNum = this.backUp.phoneNum;\n      this.editing = false;\n    },\n\n    toastMessage() {\n      this.$toast.success(\"Info updated\");\n    },\n\n    onFileSelected(event) {\n      this.selectedFile = event.target.files[0];\n    },\n\n    onUpload() {\n      if (this.selectedFile == null) {\n        this.$toast.info(\"Select a file first ...\");\n      } else {\n        if (this.selectedFile.size > 1048576) {\n          this.$toast.info(\"File is too large ...\\nMust be smaller than 1Mb\");\n        } else {\n          const fd = new FormData();\n          fd.append('image', this.selectedFile, this.selectedFile.name);\n          axios.post(\"/api/clients/loggedClient/picture\", fd, {\n            headers: {\n              \"Authorization\": `Bearer ${localStorage.getItem(\"jwt\")}`\n            }\n          }, {\n            onUploadProgress: uploadEvent => {\n              console.log(\"Upload Progress: \" + Math.round(uploadEvent.loaded / uploadEvent.total * 100) + '%');\n            }\n          }).then(response => this.picture = response.data);\n        }\n      }\n    },\n\n    dateFromLocal(dateString) {\n      if (dateString == null) {\n        return new Date();\n      }\n\n      const parts = dateString.split(\" \");\n\n      if (parts.length != 2) {\n        return new Date();\n      }\n\n      const dateParts = parts[0].split(\".\");\n\n      if (dateParts.length != 3) {\n        return new Date();\n      }\n\n      const hourParts = parts[1].split(\":\");\n\n      if (hourParts.length != 2) {\n        return new Date();\n      }\n\n      const day = dateParts[0];\n      const month = dateParts[1];\n      const year = dateParts[2];\n      const hours = hourParts[0];\n      const minutes = hourParts[1]; // new Date(year, month, day, hours, minutes, seconds, milliseconds)\n\n      const date = new Date(year, month - 1, day, hours, minutes);\n      return date;\n    },\n\n    cancelReservation(reservation, index) {\n      const date = this.dateFromLocal(reservation.start);\n      let dateCheck = new Date();\n      dateCheck.setDate(dateCheck.getDate() + 3);\n\n      if (date < dateCheck) {\n        this.$toast.error(\"You can not cancel the reservation within the 3 days\");\n      } else {\n        axios.put(\"/api/clients/cancelReservation\", reservation, {\n          headers: {\n            \"Authorization\": `Bearer ${localStorage.getItem(\"jwt\")}`\n          }\n        }).then(response => {\n          if (response.data == true) {\n            this.$toast.success(\"You have successfully canceled the reservation\");\n            this.reservations.splice(index, 1);\n          } else {\n            this.$toast.error(\"You can not cancel the reservation within the 3 days\");\n          }\n        });\n      }\n    },\n\n    msToTime(seconds) {\n      seconds = Number(seconds) / 1000;\n      var d = Math.floor(seconds / (3600 * 24));\n      var h = Math.floor(seconds % (3600 * 24) / 3600);\n      var dDisplay = d > 0 ? d + (d == 1 ? \" day \" : \" days \") : \"\";\n\n      if (h != 0) {\n        dDisplay = d > 0 ? d + (d == 1 ? \" day, \" : \" days, \") : \"\";\n        var hDisplay = h > 0 ? h + (h == 1 ? \" hour \" : \" hours \") : \"\";\n        return dDisplay + hDisplay;\n      }\n\n      return dDisplay;\n    },\n\n    rateRE(reservationHistory) {\n      const review = {\n        \"id\": 0,\n        'rentingEntityId': reservationHistory.rentingEntityId,\n        'rentingOwnerId': reservationHistory.rentingEntityOwnerId,\n        'clientId': 0,\n        'rating': this.ratingRE,\n        'comment': this.commentRatingRE\n      };\n      axios.post(\"/api/clients/addReviewRE\", review, {\n        headers: {\n          \"Authorization\": `Bearer ${localStorage.getItem(\"jwt\")}`\n        }\n      }).then(response => {\n        if (response.data == true) {\n          this.$toast.success(\"Review Added\");\n        } else {\n          this.$toast.error(\"Error\");\n        }\n      });\n    },\n\n    rateRO(reservationHistory) {\n      const review = {\n        \"id\": 0,\n        'rentingEntityId': reservationHistory.rentingEntityId,\n        'rentingOwnerId': reservationHistory.rentingEntityOwnerId,\n        'clientId': 0,\n        'rating': this.ratingRO,\n        'comment': this.commentRatingRO\n      };\n      axios.post(\"/api/clients/addReviewRO\", review, {\n        headers: {\n          \"Authorization\": `Bearer ${localStorage.getItem(\"jwt\")}`\n        }\n      }).then(response => {\n        if (response.data == true) {\n          this.$toast.success(\"Review Added\");\n        } else {\n          this.$toast.error(\"Error\");\n        }\n      });\n    },\n\n    reportRE(reservationHistory) {\n      if (this.commentReportRE.length < 5) {\n        this.$toast.error(\"Provide a comment\");\n        return;\n      }\n\n      const complaint = {\n        \"id\": 0,\n        \"complainantId\": 0,\n        \"rentingEntityId\": reservationHistory.rentingEntityId,\n        \"respodentId\": 0,\n        \"text\": this.commentReportRE\n      };\n      axios.post(\"/api/clients/addComplaintRE\", complaint, {\n        headers: {\n          \"Authorization\": `Bearer ${localStorage.getItem(\"jwt\")}`\n        }\n      }).then(response => {\n        if (response.data == true) {\n          this.$toast.success(\"Complaint Sent\");\n        } else {\n          this.$toast.error(\"Error\");\n        }\n      });\n    },\n\n    reportRO(reservationHistory) {\n      if (this.commentReportRO.length < 5) {\n        this.$toast.error(\"Provide a comment\");\n        return;\n      }\n\n      const complaint = {\n        \"id\": 0,\n        \"complainantId\": 0,\n        \"rentingEntityId\": 0,\n        \"respodentId\": reservationHistory.rentingEntityOwnerId,\n        \"text\": this.commentReportRO\n      };\n      axios.post(\"/api/clients/addComplaintRO\", complaint, {\n        headers: {\n          \"Authorization\": `Bearer ${localStorage.getItem(\"jwt\")}`\n        }\n      }).then(response => {\n        if (response.data == true) {\n          this.$toast.success(\"Complaint Sent\");\n        } else {\n          this.$toast.error(\"Error\");\n        }\n      });\n    },\n\n    includesH(row) {\n      const name = row.place.toString().toLowerCase();\n      const rentingEntityName = row.rentingEntityName.toString().toLowerCase();\n      const price = row.price.toString().toLowerCase();\n      const searchTerm = this.filterH.toLowerCase();\n      return name.includes(searchTerm) || rentingEntityName.includes(searchTerm) || price.includes(searchTerm);\n    },\n\n    sort(a, b, sortType) {\n      if (sortType == 0) {\n        let fa = a.place.toLowerCase(),\n            fb = b.place.toLowerCase();\n\n        if (fa < fb) {\n          return -1;\n        }\n\n        if (fa > fb) {\n          return 1;\n        }\n\n        return 0;\n      } else if (sortType == 1) {\n        let fa = a.place.toLowerCase(),\n            fb = b.place.toLowerCase();\n\n        if (fa > fb) {\n          return -1;\n        }\n\n        if (fa < fb) {\n          return 1;\n        }\n\n        return 0;\n      }\n\n      if (sortType == 2) {\n        let fa = parseInt(a.price),\n            fb = parseInt(b.price);\n\n        if (fa > fb) {\n          return -1;\n        }\n\n        if (fa < fb) {\n          return 1;\n        }\n\n        return 0;\n      } else if (sortType == 3) {\n        let fa = parseInt(a.price),\n            fb = parseInt(b.price);\n\n        if (fa < fb) {\n          return -1;\n        }\n\n        if (fa > fb) {\n          return 1;\n        }\n\n        return 0;\n      }\n    }\n\n  }\n};","map":{"version":3,"mappings":"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","names":["axios","name","data","user","backUp","selectedFile","picture","editing","validNumber","phoneNum","oldPassword","newPassword","confirmPassword","subscriptions","text","reservationsHistory","selectedReservationHistory","reservations","filterR","filterH","ratingRE","commentRatingRE","commentRatingRO","ratingRO","sortTypeR","sortTypeH","commentReportRE","commentReportRO","mounted","get","headers","localStorage","getItem","then","response","catch","errorP","status","$root","accessToken","setItem","$router","push","computed","filteredReservationsHistory","filter","row","includesH","sort","a","b","filteredReservations","methods","toggleEdit","firstName","lastName","address","city","country","changePassword","passwordRegex","length","$toast","error","test","passwordChange","console","log","put","signedIn","window","location","href","sendDeleteRequest","request","id","username","post","success","unsubscribe","subscription","index","splice","saveEdit","regExp","charAt","toUpperCase","slice","toastMessage","telValidate","valid","number","cancelEdit","onFileSelected","event","target","files","onUpload","info","size","fd","FormData","append","onUploadProgress","uploadEvent","Math","round","loaded","total","dateFromLocal","dateString","Date","parts","split","dateParts","hourParts","day","month","year","hours","minutes","date","cancelReservation","reservation","start","dateCheck","setDate","getDate","msToTime","seconds","Number","d","floor","h","dDisplay","hDisplay","rateRE","reservationHistory","review","rentingEntityId","rentingEntityOwnerId","rateRO","reportRE","complaint","reportRO","place","toString","toLowerCase","rentingEntityName","price","searchTerm","includes","sortType","fa","fb","parseInt"],"sourceRoot":"","sources":["C:\\Users\\draga\\OneDrive\\Dokumenti\\MRS-ISA-PROJEKAT\\mrs-isa-projekat\\projekat\\src\\frontend\\src\\components\\ClientProfile.vue"],"sourcesContent":["<template>\r\n  <head>\r\n      <title>User Profile</title>\r\n  </head>\r\n  <body >     \r\n    <div class=\"grid\">    \r\n     \r\n        <div class=\"top-left-cell\">\r\n          <button v-if=\"!this.editing\" @click=\"toggleEdit()\" class=\"btn btn-primary\">Edit Info</button>        \r\n          <button  class=\"btn btn-primary\"  data-bs-toggle=\"modal\" data-bs-target=\"#modalRequest\">Delete My Account</button>  \r\n        </div>\r\n\r\n        <div v-if=\"!this.editing\" class=\"center-left-cell\">\r\n          <img v-bind:src=\"'data:image/jpeg;base64,' + picture\" style=\"width: 300px; height: 200px;\">\r\n          <br><br>\r\n          <h1>{{user.firstName}} {{user.lastName}} </h1>        \r\n          <p>E-mail: {{user.email}}</p>\r\n          <p>Address: {{user.address}}</p>\r\n          <p>City: {{user.city}}</p>\r\n          <p>Country: {{user.country}}</p>\r\n          <p>Phone Number: {{user.phoneNum}} </p>\r\n          <p>Penalties: {{user.penalties}}</p>\r\n        </div>\r\n        <div v-else class=\"center-left-cell\">\r\n          <img v-bind:src=\"'data:image/jpeg;base64,' + picture\" style=\"width: 300px; height: 200px;\">     \r\n          <br><br>\r\n          <input type=\"file\" @change=\"onFileSelected\" accept=\"image/png, image/jpeg\" >\r\n          <button class=\"btn btn-secondary\" @click=\"onUpload\">Upload</button>\r\n          <br><br>\r\n          <div class=\"input-group mb-3\">\r\n            <span class=\"input-group-text\" id=\"firstName\">First Name:</span>\r\n            <input v-model=\"user.firstName\" type=\"text\" class=\"form-control\" aria-label=\"Username\" aria-describedby=\"firstName\">\r\n          </div>\r\n          <div class=\"input-group mb-3\">\r\n            <span class=\"input-group-text\" id=\"lastName\">Last Name:</span>\r\n            <input v-model=\"user.lastName\" type=\"text\" class=\"form-control\" aria-label=\"Username\" aria-describedby=\"lastName\">\r\n          </div>\r\n          <div class=\"input-group mb-3\">\r\n            <span class=\"input-group-text\" id=\"address\">Address: </span>\r\n            <input v-model=\"user.address\" type=\"text\" class=\"form-control\" aria-label=\"Username\" aria-describedby=\"address\">\r\n          </div>\r\n          <div class=\"input-group mb-3\">\r\n            <span class=\"input-group-text\" id=\"city\">City:</span>\r\n            <input v-model=\"user.city\" type=\"text\" class=\"form-control\" aria-label=\"Username\" aria-describedby=\"city\">\r\n          </div>\r\n          <div>\r\n            <country-select class=\"form-select\" v-model=\"user.country\" :usei18n=\"false\" :autocomplete=\"true\" :countryName=\"true\"/>\r\n          </div>\r\n          <br>\r\n          <vue-tel-input v-model=\"phoneNum\" @validate=\"telValidate\"></vue-tel-input>\r\n          <div>\r\n            <button style=\"margin-right: 20px\" class=\"btn btn-primary\" @click=\"saveEdit()\">Save</button>\r\n            <button class=\"btn btn-primary\" @click=\"cancelEdit()\">Cancel</button>\r\n          </div>\r\n        </div>\r\n        <div class=\"bot-left-cell\">\r\n         <button  class=\"btn btn-primary\" data-bs-toggle=\"modal\" data-bs-target=\"#modalSubscriptions\">My Subscriptions</button>\r\n         <button  class=\"btn btn-primary\" data-bs-toggle=\"modal\" data-bs-target=\"#modalDelete\">Change Password</button>\r\n        </div>\r\n   \r\n\r\n\r\n      <div class=\"modal fade\" id=\"modalRequest\" tabindex=\"-1\" aria-hidden=\"true\">\r\n          <div class=\"modal-dialog\">\r\n            <div class=\"modal-content\">\r\n              <div class=\"modal-body\">\r\n                  <textarea v-model=\"text\" rows=\"4\" cols=\"50\" placeholder=\"Reason...\"/>\r\n                  <button style=\"margin-right: 20px\" class=\"btn btn-primary\" @click=\"sendDeleteRequest()\">Submit</button>\r\n              </div>\r\n              <div class=\"modal-footer\">\r\n                <button type=\"button\" class=\"custom-btn button-primary\" data-bs-dismiss=\"modal\">Close</button>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n      <div class=\"modal fade\" id=\"modalSubscriptions\" tabindex=\"-1\" aria-hidden=\"true\">\r\n          <div class=\"modal-dialog\">\r\n            <div class=\"modal-content\">\r\n              <div class=\"modal-body\">\r\n                  <div class=\"subscriptions\">\r\n                    <div v-for=\"(subscription, index) in this.subscriptions\" \r\n                        v-bind:index=\"index\" :key=\"subscription.id\" class=\"reservation\">    \r\n                        <div class=\"reservation-picture\"><img v-bind:src=\"'data:image/jpeg;base64,' + subscription.img\"></div>\r\n                        <div style=\"display: flex;\">        \r\n                            <div class=\"reservation-left\">                \r\n                            {{subscription.name}}\r\n                            </div>\r\n                            <div clas=\"reservation-right\">\r\n                              <button @click=\"unsubscribe(subscription,index)\">Unsubscribe</button>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                  </div>\r\n              </div>\r\n              <div class=\"modal-footer\">\r\n                <button type=\"button\" class=\"custom-btn button-primary\" data-bs-dismiss=\"modal\">Close</button>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <div class=\"modal fade\" id=\"modalDelete\" tabindex=\"-1\" aria-hidden=\"true\">\r\n          <div class=\"modal-dialog\">\r\n            <div class=\"modal-content\">\r\n              <div class=\"modal-body\">\r\n                <input v-model=\"oldPassword\" type=\"password\" placeholder=\"Old password\">\r\n                <input v-model=\"newPassword\" type=\"password\" placeholder=\"New password\">\r\n                <input v-model=\"confirmPassword\"  type=\"password\" placeholder=\"Confirm new password\">\r\n                <button style=\"margin-right: 20px\" class=\"btn btn-primary\" @click=\"changePassword()\">Change</button>\r\n              </div>\r\n              <div class=\"modal-footer\">\r\n                <button type=\"button\" class=\"custom-btn button-primary\" data-bs-dismiss=\"modal\">Close</button>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n    </div>\r\n\r\n\r\n    <div class=\"top-right-cell\">\r\n      <h3 class=\"main-heading\">Active Reservations</h3>\r\n      <div style=\"display: flex; align-content: space-between; margin: 15px 0 15px 0\">\r\n        <div style=\"width: 70%\">\r\n          <input class=\"input-group-text\" type=\"text\" placeholder=\"Filter by name, Renting Entity, Price...\" v-model=\"filterR\"/>\r\n        </div>\r\n        <br>\r\n        <div style=\"width: 30%\">\r\n          <div style=\"width: 95%; float: right\">\r\n            <select class=\"form-select\" v-model=\"sortTypeR\" name=\"example\">\r\n              <option value=0>Place descending</option>\r\n              <option value=1>Place ascending</option>\r\n              <option value=2>Price descending</option>\r\n              <option value=3>Price ascending</option>\r\n            </select>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    <div class=\"reservation\" v-for=\"(reservation, index) in this.filteredReservations\" v-bind:index=\"index\" :key=\"reservation.id\">\r\n      <div class=\"reservation-picture\"><img v-bind:src=\"'data:image/jpeg;base64,' + reservation.img\"></div>\r\n        <div style=\"display: flex;\">\r\n          <div class=\"reservation-left\">\r\n            <div><h5 style=\"font-weight: bold;\">{{reservation.rentingEntityName}}</h5></div>\r\n            <div><b>Address: </b> {{reservation.place}}</div>\r\n            <div><b>Price: </b> {{reservation.price}}</div>\r\n            <div><b>Starting Date: </b> {{reservation.start}}</div>\r\n            <div><b>Duration: </b> {{msToTime(reservation.duration)}}</div>\r\n            <div v-if=\"reservation.additionalServices.length != 0\"> <b>Additional Services: </b>\r\n              <span v-for=\"service in reservation.additionalServices.slice(0,-1)\" :key=\"service\"> {{service}}, </span>\r\n              <span>{{reservation.additionalServices.at(-1)}}</span>\r\n            </div>\r\n          </div>\r\n          <div class=\"reservation-right\">\r\n              <button class=\"custom-btn button-primary\" @click=\"cancelReservation(reservation, index)\">Cancel Reservation</button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n    \r\n    <div class=\"bot-right-cell\">\r\n      <h3 class=\"main-heading\">Reservation History</h3>\r\n      <div style=\"display: flex; align-content: space-between; margin: 15px 0 15px 0\">\r\n        <div style=\"width: 70%\">\r\n          <input class=\"input-group-text\" type=\"text\" placeholder=\"Filter by name, Renting Entity, Price...\" v-model=\"filterH\"/>\r\n        </div>\r\n        <br>\r\n        <div style=\"width: 30%\">\r\n          <div style=\"width: 95%; float: right\">\r\n            <select class=\"form-select\" v-model=\"sortTypeH\" name=\"example\">\r\n              <option value=0>Place descending</option>\r\n              <option value=1>Place ascending</option>\r\n              <option value=2>Price descending</option>\r\n              <option value=3>Price ascending</option>\r\n            </select>\r\n          </div>\r\n        </div>\r\n      </div>\r\n      <div class=\"reservation\" v-for=\"(reservationHistory, index) in this.filteredReservationsHistory\" v-bind:index=\"index\" :key=\"reservationHistory.id\">\r\n        <div class=\"reservation-picture\"><img v-bind:src=\"'data:image/jpeg;base64,' + reservationHistory.img\"></div>\r\n        <div style=\"display: flex;\">\r\n          <div class=\"reservation-left\">\r\n            <div><h5 style=\"font-weight: bold;\">{{reservationHistory.rentingEntityName}}</h5></div>\r\n            <div><b>Address: </b> {{reservationHistory.place}}</div>\r\n            <div><b>Price: </b> {{reservationHistory.price}}</div>\r\n            <div><b>Starting Date: </b> {{reservationHistory.start}}</div>\r\n            <div><b>Duration: </b> {{msToTime(reservationHistory.duration)}}</div>\r\n            <div v-if=\"reservationHistory.additionalServices.length != 0\"> <b>Additional Services: </b>\r\n              <span v-for=\"service in reservationHistory.additionalServices.slice(0,-1)\" :key=\"service\"> {{service}}, </span>\r\n              <span>{{reservationHistory.additionalServices.at(-1)}}</span>\r\n            </div>\r\n          </div>\r\n          <div class=\"reservation-right\">\r\n            <button style=\"margin-right: 10px\" class=\"custom-btn button-primary\" data-bs-toggle=\"modal\" data-bs-target=\"#modalRate\">Rate</button>\r\n            <button class=\"custom-btn button-primary\" data-bs-toggle=\"modal\" data-bs-target=\"#modalReport\">Report</button>\r\n          </div>\r\n        </div>\r\n\r\n        <div class=\"modal fade\" id=\"modalRate\" tabindex=\"-1\" aria-hidden=\"true\">\r\n          <div class=\"modal-dialog\">\r\n            <div class=\"modal-content\">\r\n              <div class=\"modal-body\">\r\n                <div>\r\n                  <vue3-star-ratings :showControl=false v-model=\"ratingRE\"/>\r\n                  <textarea v-model=\"commentRatingRE\" style=\"height: 100px\" type=\"text\" class=\"form-control\" placeholder=\"Comment...\"></textarea><br>\r\n                  <button class=\"custom-btn button-primary\" @click=\"rateRE(reservationHistory)\">Rate renting entity</button>\r\n                </div>\r\n                <div>\r\n                  <vue3-star-ratings :showControl=false v-model=\"ratingRO\"/>\r\n                  <textarea v-model=\"commentRatingRO\" style=\"height: 100px\" type=\"text\" class=\"form-control\" placeholder=\"Comment...\"></textarea><br>\r\n\r\n                  <button class=\"custom-btn button-primary\" @click=\"rateRO(reservationHistory)\">Rate owner</button>\r\n                </div>\r\n              </div>\r\n              <div class=\"modal-footer\">\r\n                <button type=\"button\" class=\"custom-btn button-primary\" data-bs-dismiss=\"modal\">Close</button>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <div class=\"modal fade\" id=\"modalReport\" tabindex=\"-1\" aria-hidden=\"true\">\r\n          <div class=\"modal-dialog\">\r\n            <div class=\"modal-content\">\r\n              <div class=\"modal-body\">\r\n                <div>\r\n                  <textarea v-model=\"commentReportRE\" style=\"height: 100px\" type=\"text\" class=\"form-control\" placeholder=\"Comment...\"></textarea><br>\r\n                  <button class=\"custom-btn button-primary\" @click=\"reportRE(reservationHistory)\">Submit Report</button>\r\n                </div>\r\n                <div>\r\n                  <br><textarea v-model=\"commentReportRO\" style=\"height: 100px\" type=\"text\" class=\"form-control\" placeholder=\"Comment...\"></textarea><br>\r\n                  <button class=\"custom-btn button-primary\" @click=\"reportRO(reservationHistory)\">Submit Report</button><br>\r\n                </div>\r\n              </div>\r\n              <div class=\"modal-footer\">\r\n                <button type=\"button\" class=\"custom-btn button-primary\" data-bs-dismiss=\"modal\">Close</button>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n\r\n\r\n  </body>\r\n</template>\r\n\r\n<script>\r\nimport axios from \"axios\"\r\nexport default {\r\n  name: \"ClientProfile\",\r\n  data() {\r\n    return {\r\n      user:{},\r\n      backUp:{},      \r\n      selectedFile: null,\r\n      picture: null,\r\n      editing: false,\r\n      validNumber: '',\r\n      phoneNum: null,\r\n      oldPassword:\"\",\r\n      newPassword:\"\",\r\n      confirmPassword:\"\",\r\n      subscriptions:[],\r\n      text: \"\",\r\n      reservationsHistory:[],\r\n      selectedReservationHistory:{},\r\n      reservations:[],\r\n      filterR:\"\",\r\n      filterH: \"\",\r\n      ratingRE:5,\r\n      commentRatingRE:\"\",\r\n      commentRatingRO:\"\",\r\n      ratingRO:5,\r\n      sortTypeR:0,\r\n      sortTypeH: 0,\r\n      commentReportRE:\"\",\r\n      commentReportRO:\"\",\r\n\r\n            }\r\n    },\r\n     mounted() {\r\n      axios\r\n        .get(\"/api/clients/loggedClient\",{ headers: {\"Authorization\" : `Bearer ${localStorage.getItem(\"jwt\")}`} } )\r\n        .then(response => (this.user = response.data)).catch((errorP) => {\r\n        \r\n        if(errorP.response.status===401){\r\n          //this.$toast.error(\"Not Logged In\");\r\n          this.$root.accessToken=null;\r\n          localStorage.setItem(\"jwt\",null);\r\n          \r\n          this.$router.push(\"/loginPage\");\r\n        }\r\n       \r\n      });\r\n      axios.get(\"/api/users/loggedUser/picture\",{ headers: {\"Authorization\" : `Bearer ${localStorage.getItem(\"jwt\")}`} }).then(response => (this.picture=response.data)).catch((errorP) => {\r\n        \r\n        if(errorP.response.status===401){\r\n          //this.$toast.error(\"Not Logged In\");\r\n          this.$root.accessToken=null;\r\n          localStorage.setItem(\"jwt\",null);\r\n          \r\n          this.$router.push(\"/loginPage\");\r\n        }\r\n       \r\n      });  \r\n      axios.get(\"/api/clients/subscriptions\",{ headers: {\"Authorization\" : `Bearer ${localStorage.getItem(\"jwt\")}`} }).then(response => (this.subscriptions=response.data)).catch((errorP) => {\r\n        \r\n        if(errorP.response.status===401){\r\n          //this.$toast.error(\"Not Logged In\");\r\n          this.$root.accessToken=null;\r\n          localStorage.setItem(\"jwt\",null);          \r\n          this.$router.push(\"/loginPage\");\r\n        }\r\n       \r\n      }); \r\n        axios.get(\"/api/clients/loggedClient/reservations\",{ headers: {\"Authorization\" : `Bearer ${localStorage.getItem(\"jwt\")}`} }).then(response => (this.reservations=response.data)).catch((errorP) => {\r\n        \r\n        if(errorP.response.status===401){\r\n          //this.$toast.error(\"Not Logged In\");\r\n          this.$root.accessToken=null;\r\n          localStorage.setItem(\"jwt\",null);          \r\n          this.$router.push(\"/loginPage\");\r\n        }\r\n       \r\n      });\r\n        axios.get(\"/api/clients/loggedClient/reservationHistory\",{ headers: {\"Authorization\" : `Bearer ${localStorage.getItem(\"jwt\")}`} }).then(response => (this.reservationsHistory=response.data)).catch((errorP) => {\r\n        \r\n        if(errorP.response.status===401){\r\n          //this.$toast.error(\"Not Logged In\");\r\n          this.$root.accessToken=null;\r\n          localStorage.setItem(\"jwt\",null);          \r\n          this.$router.push(\"/loginPage\");\r\n        }\r\n       \r\n      }); \r\n   \r\n    },\r\n    computed: {\r\n    filteredReservationsHistory() {\r\n      return this.reservationsHistory.filter(row => {\r\n        return this.includesH(row);\r\n      }).sort((a,b)=>{\r\n        return this.sort(a,b,this.sortTypeH);})\r\n    },\r\n    filteredReservations(){\r\n       return this.reservations.filter(row => {\r\n        return this.includesH(row);\r\n      }).sort((a,b)=>{\r\n        return this.sort(a,b,this.sortTypeR);})\r\n    }},\r\n    methods: {    \r\n    toggleEdit(){\r\n          this.backUp={\"firstName\":this.user.firstName,\"lastName\":this.user.lastName,\"address\":this.user.address,\"city\":this.user.city,\"country\":this.user.country,\"phoneNum\":this.user.phoneNum};\r\n    \r\n          this.editing=true; \r\n      },\r\n\r\n    changePassword(){\r\n      var passwordRegex=/^[0-9A-Za-z]+$/;\r\n\r\n      if(this.newPassword.length<5 || this.newPassword.length > 20){\r\n        this.$toast.error(\"Password must be between 5-20 characters\");\r\n        return;\r\n      }\r\n      if(!passwordRegex.test(this.newPassword)){\r\n        this.$toast.error(\"Password must only contain letters and numbers\");\r\n        return;\r\n      }\r\n      if(!passwordRegex.test(this.oldPassword)){\r\n        this.$toast.error(\"Password must only contain letters and numbers\");\r\n        return;\r\n      }\r\n      if(this.newPassword !== this.confirmPassword){\r\n        this.$toast.error(\"Passwords must match\");\r\n        return;\r\n      }\r\n\r\n      const passwordChange={\"oldPassword\":this.oldPassword,\"newPassword\":this.newPassword,\"newPasswordConfirm\":this.confirmPassword};\r\n      console.log(passwordChange);\r\n      axios.put(`/api/clients/changePassword`,passwordChange,{ headers: {\"Authorization\" : `Bearer ${localStorage.getItem(\"jwt\")}`} }).then(response =>{\r\n        if(response.data==true){\r\n          this.$root.accessToken=null;\r\n          this.$root.signedIn=false;\r\n          localStorage.setItem(\"jwt\",null);          \r\n          window.location.href = 'http://localhost:3000/loginPage';\r\n        }else{\r\n          this.$toast.error(\"Error\");\r\n        }\r\n      });\r\n\r\n    },\r\n\r\n    sendDeleteRequest(){\r\n      if(this.text.length<5){\r\n        this.$toast.error(\"Provide a reason\");\r\n        return;\r\n      }\r\n      const request={\"id\":0,'submitterId':this.user.id,'submitterUsername':this.user.username,'text':this.text,'type':0};\r\n      console.log(request);\r\n      axios.post(\"/api/users/submitRequest\",request,{ headers: {\"Authorization\" : `Bearer ${localStorage.getItem(\"jwt\")}`} }).then(response => {if(response.data==true){this.$toast.success(\"Request Sent\");}else{\r\n          this.$toast.error(\"Error\");\r\n      }})\r\n    },\r\n\r\n    unsubscribe(subscription,index){\r\n      axios.put(`/api/clients/unSubscribeDTO`,subscription,{ headers: {\"Authorization\" : `Bearer ${localStorage.getItem(\"jwt\")}`} }).then(response =>{\r\n        if(response.data==true){\r\n          this.$toast.success(\"Unsubscribed\");\r\n          this.subscriptions.splice(index,1);\r\n        }else{\r\n          this.$toast.error(\"Error\");\r\n        }\r\n      });\r\n    },\r\n\r\n    saveEdit(){\r\n      var regExp = /^[A-Za-z]+$/;\r\n      \r\n      if (this.user.firstName.length < 2 || this.user.firstName.length > 20) {\r\n        this.$toast.error(\"First name must be between 2-20 characters\");\r\n        return;\r\n        }\r\n      if(regExp.test(this.user.firstName)==false){\r\n        this.$toast.error(\"First name must contain only letters\");\r\n        return;\r\n      }\r\n      this.user.firstName=this.user.firstName.charAt(0).toUpperCase() + this.user.firstName.slice(1);\r\n      \r\n      if(this.user.lastName.length < 2 || this.user.lastName.length > 20){\r\n        this.$toast.error(\"Last name must be between 2-20 characters\");\r\n        return;\r\n      }\r\n      if(regExp.test(this.user.lastName)==false){\r\n        this.$toast.error(\"Last name must contain only letters\");\r\n        return;\r\n      }\r\n      this.user.lastName=this.user.lastName.charAt(0).toUpperCase() + this.user.lastName.slice(1);\r\n      if(this.user.address === ''){\r\n        this.$toast.error(\"Provide address\");\r\n        return;\r\n      }\r\n      if(this.user.city === ''){\r\n        this.$toast.error(\"Provide city name\");\r\n        return;\r\n      } \r\n      \r\n      if(this.country == \"\"){\r\n        this.$toast.error(\"Provide country\");\r\n        return;\r\n      }\r\n      if(this.validNumber===''){\r\n        this.$toast.error(\"Phone number invalid\");\r\n        return;\r\n      }\r\n          \r\n      this.user.phoneNum=this.validNumber;\r\n      \r\n      axios.post(\"/api/clients/loggedClient\",this.user,{ headers: {\"Authorization\" : `Bearer ${localStorage.getItem(\"jwt\")}`} }).then(response => this.user=response.data ).then(this.toastMessage());\r\n      this.editing=false;\r\n    },\r\n    telValidate(phoneNum) {\r\n      if (phoneNum.valid) {\r\n        this.validNumber = phoneNum.number;\r\n      } else {\r\n        this.validNumber = '';\r\n      } \r\n    },\r\n    cancelEdit(){\r\n      this.user.firstName=this.backUp.firstName;\r\n      this.user.lastName=this.backUp.lastName;\r\n      this.user.address=this.backUp.address;\r\n      this.user.city=this.backUp.city;\r\n      this.user.country=this.backUp.country;\r\n      this.user.phoneNum=this.backUp.phoneNum;\r\n      this.editing=false;\r\n    },\r\n    toastMessage(){\r\n      this.$toast.success(\"Info updated\");\r\n    },\r\n    onFileSelected(event){\r\n      this.selectedFile= event.target.files[0];\r\n    },\r\n    onUpload(){\r\n      if(this.selectedFile == null){\r\n          this.$toast.info(\"Select a file first ...\");\r\n      }else{\r\n      if(this.selectedFile.size > 1048576){\r\n        this.$toast.info(\"File is too large ...\\nMust be smaller than 1Mb\");\r\n      }else{\r\n      const fd=new FormData();\r\n      fd.append('image',this.selectedFile,this.selectedFile.name);\r\n      axios.post(\"/api/clients/loggedClient/picture\",fd,{ headers: {\"Authorization\" : `Bearer ${localStorage.getItem(\"jwt\")}`} },{\r\n        onUploadProgress: uploadEvent => {\r\n          console.log(\"Upload Progress: \"+ Math.round(uploadEvent.loaded/uploadEvent.total * 100) + '%');\r\n        }\r\n      }).then(response => (this.picture=response.data))\r\n    }}\r\n    },\r\n    dateFromLocal(dateString){\r\n      if(dateString==null){\r\n        return new Date();\r\n      }\r\n      \r\n      const parts=dateString.split(\" \");\r\n      \r\n      if( parts.length !=2){\r\n        return new Date();\r\n      }\r\n      const dateParts= parts[0].split(\".\");\r\n      \r\n      if( dateParts.length !=3){\r\n        return new Date();\r\n      }\r\n      const hourParts=parts[1].split(\":\");\r\n      \r\n      if( hourParts.length !=2){\r\n        return new Date();\r\n      }\r\n      \r\n      const day = dateParts[0];\r\n      const month = dateParts[1];\r\n      const year = dateParts[2];\r\n      const hours = hourParts[0];\r\n      const minutes = hourParts[1];\r\n      // new Date(year, month, day, hours, minutes, seconds, milliseconds)\r\n      const date= new Date(year,month-1,day,hours,minutes);\r\n      return date;\r\n    }, \r\n    cancelReservation(reservation, index){\r\n      \r\n      const date=this.dateFromLocal(reservation.start);\r\n      let dateCheck=new Date();\r\n      \r\n      dateCheck.setDate(dateCheck.getDate() + 3);\r\n\r\n      if(date < dateCheck){\r\n        this.$toast.error(\"You can not cancel the reservation within the 3 days\");\r\n      }else{\r\n        axios.put(\"/api/clients/cancelReservation\",reservation,{ headers: {\"Authorization\" : `Bearer ${localStorage.getItem(\"jwt\")}`} }).then(response => {\r\n          if(response.data == true){\r\n            this.$toast.success(\"You have successfully canceled the reservation\");\r\n            this.reservations.splice(index,1);\r\n          }else{\r\n            this.$toast.error(\"You can not cancel the reservation within the 3 days\");\r\n          }\r\n        })\r\n        \r\n      }\r\n    },\r\n\r\n    msToTime(seconds) {     \r\n      seconds = Number(seconds)/1000;\r\n      var d = Math.floor(seconds / (3600*24));\r\n      var h = Math.floor(seconds % (3600*24) / 3600);\r\n\r\n      var dDisplay = d > 0 ? d + (d == 1 ? \" day \" : \" days \") : \"\";\r\n      if (h != 0) {\r\n        dDisplay = d > 0 ? d + (d == 1 ? \" day, \" : \" days, \") : \"\";\r\n        var hDisplay = h > 0 ? h + (h == 1 ? \" hour \" : \" hours \") : \"\";\r\n        return dDisplay + hDisplay;\r\n      }\r\n\r\n      return dDisplay\r\n  },\r\n  rateRE(reservationHistory){\r\n    const review={\"id\":0,'rentingEntityId':reservationHistory.rentingEntityId,'rentingOwnerId':reservationHistory.rentingEntityOwnerId,'clientId':0,'rating':this.ratingRE,'comment':this.commentRatingRE};\r\n    axios.post(\"/api/clients/addReviewRE\",review,{ headers: {\"Authorization\" : `Bearer ${localStorage.getItem(\"jwt\")}`} }).then(response => {if(response.data==true){this.$toast.success(\"Review Added\");}else{\r\n      this.$toast.error(\"Error\");\r\n    }})\r\n  },\r\n  rateRO(reservationHistory){\r\n    const review={\"id\":0,'rentingEntityId':reservationHistory.rentingEntityId,'rentingOwnerId':reservationHistory.rentingEntityOwnerId,'clientId':0,'rating':this.ratingRO,'comment':this.commentRatingRO};\r\n    axios.post(\"/api/clients/addReviewRO\",review,{ headers: {\"Authorization\" : `Bearer ${localStorage.getItem(\"jwt\")}`} }).then(response => {if(response.data==true){this.$toast.success(\"Review Added\");}else{\r\n      this.$toast.error(\"Error\");\r\n    }})\r\n\r\n  },\r\n  reportRE(reservationHistory){\r\n    if(this.commentReportRE.length<5){\r\n        this.$toast.error(\"Provide a comment\");\r\n        return;\r\n      }\r\n \r\n    const complaint={\"id\":0,\"complainantId\":0,\"rentingEntityId\":reservationHistory.rentingEntityId,\"respodentId\":0,\"text\":this.commentReportRE};\r\n    axios.post(\"/api/clients/addComplaintRE\",complaint,{ headers: {\"Authorization\" : `Bearer ${localStorage.getItem(\"jwt\")}`} }).then(response => {if(response.data==true){this.$toast.success(\"Complaint Sent\");}else{\r\n          this.$toast.error(\"Error\");\r\n        }})\r\n  },\r\n  reportRO(reservationHistory){\r\n    if(this.commentReportRO.length<5){\r\n        this.$toast.error(\"Provide a comment\");\r\n        return;\r\n      }\r\n    const complaint={\"id\":0,\"complainantId\":0,\"rentingEntityId\":0,\"respodentId\":reservationHistory.rentingEntityOwnerId,\"text\":this.commentReportRO};\r\n    axios.post(\"/api/clients/addComplaintRO\",complaint,{ headers: {\"Authorization\" : `Bearer ${localStorage.getItem(\"jwt\")}`} }).then(response => {if(response.data==true){this.$toast.success(\"Complaint Sent\");}else{\r\n          this.$toast.error(\"Error\");\r\n        }})\r\n  },\r\n  includesH(row){\r\n        \r\n        const name = row.place.toString().toLowerCase();\r\n        const rentingEntityName = row.rentingEntityName.toString().toLowerCase();\r\n        const price = row.price.toString().toLowerCase();\r\n        const searchTerm = this.filterH.toLowerCase();\r\n        return (name.includes(searchTerm) || rentingEntityName.includes(searchTerm) || price.includes(searchTerm))\r\n        \r\n    },\r\n    sort(a,b,sortType){\r\n        if(sortType==0){\r\n          let fa = a.place.toLowerCase(), fb = b.place.toLowerCase();\r\n          if (fa < fb) {\r\n            return -1\r\n          }\r\n          if (fa > fb) {\r\n            return 1\r\n          }\r\n          return 0\r\n        }\r\n        else if (sortType== 1){\r\n          let fa = a.place.toLowerCase(), fb = b.place.toLowerCase();\r\n           if (fa > fb) {\r\n            return -1\r\n          }\r\n          if (fa < fb) {\r\n            return 1\r\n          }\r\n          return 0\r\n        }\r\n        if(sortType==2){\r\n        let fa =parseInt(a.price), fb =parseInt(b.price)\r\n        \r\n          if (fa > fb) {\r\n            return -1\r\n          }\r\n          if (fa < fb) {\r\n            return 1\r\n          }\r\n          return 0\r\n        }\r\n        else if (sortType == 3){\r\n          \r\n          let fa = parseInt(a.price), fb =parseInt(b.price);\r\n          \r\n           if (fa < fb) {\r\n            return -1\r\n          }\r\n          if (fa > fb) {\r\n            return 1\r\n          }\r\n          return 0\r\n        }\r\n\r\n    },\r\n  }\r\n\r\n  \r\n}\r\n</script>\r\n\r\n<style scoped>\r\n\r\n.grid{\r\n  display: grid; \r\n  grid-template-columns: 1fr 2fr; \r\n  grid-template-rows: 1fr 1fr 1fr 1fr; \r\n  gap: 10px 10px; \r\n  justify-content: center; \r\n  align-content: center; \r\n  justify-items: center; \r\n  align-items: center; \r\n}\r\n\r\n.top-left-cell{\r\n  grid-column: 1;\r\n  grid-row: 1;\r\n}\r\n\r\n.center-left-cell{\r\n  grid-column: 1;\r\n  grid-row: 2 / 3;\r\n}\r\n\r\n.bot-left-cell{\r\n  grid-column: 1;\r\n  grid-row: 3;\r\n}\r\n\r\n.bot-right-cell{\r\n  grid-column: 2;\r\n  grid-row: 1;\r\n}\r\n\r\n.top-right-cell{\r\n  grid-column-start: 2;\r\n  grid-column-end: 3;\r\n  grid-row-start: 3;\r\n  grid-row-end: 5;\r\n}\r\n\r\n.reservation {\r\n  text-align: center;\r\n  width: 100%;\r\n  height: 170px;\r\n  border: 1px solid darkgrey;\r\n  border-radius: 5px;\r\n  overflow: hidden;\r\n  margin-bottom: 10px;\r\n}\r\n\r\n.reservation-picture img {\r\n  object-fit: cover;\r\n  margin: 10px;\r\n  border-radius: 5px;\r\n  width: 200px;\r\n  height: 150px;\r\n}\r\n\r\n.reservation-picture {\r\n  float:left;\r\n}\r\n\r\n.reservation-left {\r\n  float: left;\r\n  margin: 10px;\r\n  text-align: left;\r\n  width: 60%;\r\n}\r\n\r\n.reservation-right {\r\n  float: right;\r\n  margin: auto;\r\n  text-align: center;\r\n  width: 30%;\r\n  overflow: hidden;\r\n}\r\n\r\n</style>"]},"metadata":{},"sourceType":"module"}