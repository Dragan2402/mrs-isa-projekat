{"ast":null,"code":"import axios from \"axios\";\nimport { useRoute } from 'vue-router';\nimport { getCurrentInstance, onMounted, ref } from 'vue';\nexport default {\n  name: \"VacationHouseProfile\",\n\n  setup() {\n    const route = useRoute();\n    const toast = getCurrentInstance().appContext.config.globalProperties.$toast;\n    let id = ref('3');\n    let vacationHouse = ref({\n      id: null,\n      name: null,\n      address: null,\n      promoDescription: null,\n      availableFrom: null,\n      availableTo: null,\n      behaviourRules: null,\n      priceList: null,\n      additionalInfo: null,\n      cancellationConditions: null,\n      roomsQuantity: null,\n      bedsPerRoom: null,\n      reviewsNumber: null\n    });\n    let offer = ref({\n      id: null,\n      place: null,\n      clientLimit: null,\n      additionalServices: [],\n      price: null,\n      rentingEntityId: null,\n      start: null,\n      duration: null\n    });\n    let pictures = ref([]);\n    let modalShown = ref(false);\n    let availabilityInterval = ref({\n      start: undefined,\n      end: undefined\n    });\n    let offerInterval = ref();\n    let calendarAttributes = ref([{\n      key: 'available',\n      highlight: {\n        start: {\n          fillMode: 'outline'\n        },\n        base: {\n          fillMode: 'light'\n        },\n        end: {\n          fillMode: 'outline'\n        }\n      },\n      dates: {\n        start: undefined,\n        end: undefined\n      }\n    }]);\n    let fromDate = ref();\n    onMounted(() => {\n      if (route.params.id !== undefined) {\n        id.value = route.params.id;\n      }\n\n      axios.get(`/api/vacationHouses/anyUser/${id.value}`, {\n        headers: {\n          \"Authorization\": `Bearer ${localStorage.getItem(\"jwt\")}`\n        }\n      }).then(response => {\n        vacationHouse.value = response.data;\n        let from = stringToDateTime(vacationHouse.value.availableFrom);\n        let to = stringToDateTime(vacationHouse.value.availableTo);\n        availabilityInterval.value.start = from;\n        availabilityInterval.value.end = to;\n        calendarAttributes.value[0].dates.start = from;\n        calendarAttributes.value[0].dates.end = to;\n        fromDate.value = availabilityInterval.value.start;\n      });\n      axios.get(`/api/vacationHouses/anyUser/${id.value}/pictures/all`, {\n        headers: {\n          \"Authorization\": `Bearer ${localStorage.getItem(\"jwt\")}`\n        }\n      }).then(response => {\n        for (let i = 0; i < response.data.length; i++) {\n          pictures.value.push(response.data[i]);\n        }\n      });\n    });\n\n    function showModal() {\n      modalShown.value = true;\n    }\n\n    function hideModal() {\n      modalShown.value = false;\n    }\n\n    function saveEdit() {\n      if (availabilityInterval.value.start != undefined && availabilityInterval.value.end != undefined) {\n        vacationHouse.value.availableFrom = dateTimeToString(availabilityInterval.value.start);\n        vacationHouse.value.availableTo = dateTimeToString(availabilityInterval.value.end);\n        calendarAttributes.value[0].dates.start = availabilityInterval.value.start;\n        calendarAttributes.value[0].dates.end = availabilityInterval.value.end;\n        axios.put(`/api/vacationHouses/loggedVacationHouseOwner/${id.value}`, vacationHouse.value, {\n          headers: {\n            \"Authorization\": `Bearer ${localStorage.getItem(\"jwt\")}`\n          }\n        }).then(response => {\n          vacationHouse.value = response.data;\n          toast.success(\"Info updated\");\n        }).catch(error => {\n          if (error.response.status === 401) {\n            toast.error(\"Error: Unauthorized access\");\n          } else if (error.response.status === 400) {\n            toast.error(\"Error: Invalid data\");\n          }\n        });\n      } else {\n        toast.error(\"Error: Invalid dates\");\n      }\n\n      modalShown.value = false;\n    }\n\n    function createOffer() {\n      offer.value.start = dateTimeToString(offerInterval.value[0]);\n      offer.value.duration = offerInterval.value[1] - offerInterval.value[0];\n      offer.value.rentingEntityId = id.value;\n      axios.post(\"/api/offers/new\", offer.value, {\n        headers: {\n          \"Authorization\": `Bearer ${localStorage.getItem(\"jwt\")}`\n        }\n      }).then(response => {\n        offer.value = response.data;\n        toast.success(\"Info updated\");\n      });\n      modalShown.value = false;\n    }\n\n    function stringToDateTime(s) {\n      let tokens = s.split(\" \");\n      let date = tokens[0];\n      let time = tokens[1];\n      tokens = date.split(\".\");\n      let day = parseInt(tokens[0]);\n      let month = parseInt(tokens[1]) - 1;\n      let year = parseInt(tokens[2]);\n      tokens = time.split(\":\");\n      let hour = parseInt(tokens[0]);\n      let minute = parseInt(tokens[1]);\n      return new Date(year, month, day, hour, minute);\n    }\n\n    function dateTimeToString(dt) {\n      let day = (\"0\" + dt.getDate()).slice(-2);\n      let month = (\"0\" + (dt.getMonth() + 1)).slice(-2);\n      let year = dt.getFullYear();\n      let hour = (\"0\" + dt.getHours()).slice(-2);\n      let minute = (\"0\" + dt.getMinutes()).slice(-2);\n      return `${day}.${month}.${year} ${hour}:${minute}`;\n    }\n\n    const formatRange = dates => {\n      let from = dates[0];\n      let to = dates[1];\n      const dayFrom = from.getDate();\n      const monthFrom = from.getMonth() + 1;\n      const yearFrom = from.getFullYear();\n      const hourFrom = from.getHours();\n      const minuteFrom = from.getMinutes();\n      const dayTo = to.getDate();\n      const monthTo = to.getMonth() + 1;\n      const yearTo = to.getFullYear();\n      const hourTo = to.getHours();\n      const minuteTo = to.getMinutes();\n      return `${dayFrom}.${monthFrom}.${yearFrom} ${hourFrom}:${minuteFrom} - ${dayTo}.${monthTo}.${yearTo} ${hourTo}:${minuteTo}`;\n    };\n\n    return {\n      id,\n      vacationHouse,\n      offer,\n      pictures,\n      modalShown,\n      availabilityInterval,\n      offerInterval,\n      calendarAttributes,\n      fromDate,\n      formatRange,\n      showModal,\n      hideModal,\n      stringToDateTime,\n      dateTimeToString,\n      saveEdit,\n      createOffer\n    };\n  }\n\n};","map":{"version":3,"mappings":"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","names":["axios","useRoute","getCurrentInstance","onMounted","ref","name","setup","route","toast","appContext","config","globalProperties","$toast","id","vacationHouse","address","promoDescription","availableFrom","availableTo","behaviourRules","priceList","additionalInfo","cancellationConditions","roomsQuantity","bedsPerRoom","reviewsNumber","offer","place","clientLimit","additionalServices","price","rentingEntityId","start","duration","pictures","modalShown","availabilityInterval","undefined","end","offerInterval","calendarAttributes","key","highlight","fillMode","base","dates","fromDate","params","value","get","headers","localStorage","getItem","then","response","data","from","stringToDateTime","to","i","length","push","showModal","hideModal","saveEdit","dateTimeToString","put","success","catch","error","status","createOffer","post","s","tokens","split","date","time","day","parseInt","month","year","hour","minute","Date","dt","getDate","slice","getMonth","getFullYear","getHours","getMinutes","formatRange","dayFrom","monthFrom","yearFrom","hourFrom","minuteFrom","dayTo","monthTo","yearTo","hourTo","minuteTo"],"sourceRoot":"","sources":["C:\\Users\\draga\\OneDrive\\Dokumenti\\MRS-ISA-PROJEKAT\\mrs-isa-projekat\\projekat\\src\\frontend\\src\\components\\VacationHouseProfile.vue"],"sourcesContent":["<template>\r\n  <div class=\"main-container\">\r\n    <div class=\"heading-flex\">\r\n      <div class=\"heading-left\">\r\n        <h3 class=\"main-heading\">{{vacationHouse.name}}</h3>\r\n        <vue3-star-ratings class=\"star-ratings\" v-model=\"vacationHouse.rating\" starSize=\"22\"  :showControl=false :disableClick=true :step=0 />\r\n        <h5 class=\"star-heading\">({{vacationHouse.reviewsNumber}})</h5>\r\n      </div>\r\n      <div class=\"heading-right\">\r\n        <div class=\"heading-right-buttons\">\r\n          <button style=\"margin-right: 20px\" @click=\"showModal()\" type=\"button\" class=\"custom-btn button-primary\" data-bs-toggle=\"modal\" data-bs-target=\"#modal\">Edit info</button>\r\n          <button type=\"button\" @click=\"showModal()\" class=\"custom-btn button-primary\" data-bs-toggle=\"modal\" data-bs-target=\"#modalOffer\">Create offer</button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n    <div id=\"carouselExampleControls\" class=\"carousel slide\" data-bs-ride=\"carousel\">\r\n      <div class=\"carousel-inner\">\r\n        <div class=\"carousel-item active\">\r\n          <img class=\"carousel-image d-block w-100\" alt=\"Active picture\" v-bind:src=\"'data:image/jpeg;base64,' + pictures.at(0)\">\r\n        </div>\r\n        <div class=\"carousel-item\" v-for=\"(picture, index) in pictures.slice(1)\" :key=\"index\">\r\n          <img class=\"carousel-image d-block w-100\" alt=\"Item picture\" v-bind:src=\"'data:image/jpeg;base64,' + picture\">\r\n        </div>\r\n      </div>\r\n      <button class=\"carousel-control-prev\" type=\"button\" data-bs-target=\"#carouselExampleControls\" data-bs-slide=\"prev\">\r\n        <span class=\"carousel-control-prev-icon\" aria-hidden=\"true\"></span>\r\n        <span class=\"visually-hidden\">Previous</span>\r\n      </button>\r\n      <button class=\"carousel-control-next\" type=\"button\" data-bs-target=\"#carouselExampleControls\" data-bs-slide=\"next\">\r\n        <span class=\"carousel-control-next-icon\" aria-hidden=\"true\"></span>\r\n        <span class=\"visually-hidden\">Next</span>\r\n      </button>\r\n    </div>\r\n    <div class=\"main-description\">\r\n      <div class=\"inner-description\">\r\n        <div><b>Address: </b> {{vacationHouse.address}}</div>\r\n        <div><b>Description: </b> {{vacationHouse.promoDescription}}</div>\r\n        <div><b>Behaviour rules: </b> {{vacationHouse.behaviourRules}}</div>\r\n        <div><b>Price: </b> {{vacationHouse.priceList}} per day</div>\r\n        <div><b>Additional info: </b>{{vacationHouse.additionalInfo}}</div>\r\n        <div><b>Cancellation conditions: </b>{{vacationHouse.cancellationConditions}}</div>\r\n        <div><b>Capacity: </b>{{vacationHouse.roomsQuantity}} rooms, {{vacationHouse.bedsPerRoom}} beds per room</div>\r\n      </div>\r\n      <div class=\"google-map-container\">\r\n        <iframe class=\"google-map\" v-bind:src=\"'https://maps.google.com/maps?q=' + vacationHouse.address + '&t=&z=13&ie=UTF8&iwloc=&output=embed'\"></iframe>\r\n      </div>\r\n    </div>\r\n    <hr>\r\n    <div v-if=\"vacationHouse.availableFrom != null && vacationHouse.availableFrom != null\" v >\r\n      <h4>Available dates:</h4>\r\n      <v-calendar style=\"width: 100%\" id=\"calendar\" class=\"mb-3\" :from-date=\"fromDate\" :attributes=\"calendarAttributes\"\r\n                  :min-date=\"calendarAttributes[0].dates.start\" :max-date=\"calendarAttributes[0].dates.end\" /><br>\r\n    </div>\r\n  </div>\r\n  <div class=\"modal fade\" id=\"modal\" tabindex=\"-1\" aria-hidden=\"true\">\r\n    <div class=\"modal-dialog modal-lg\">\r\n      <div class=\"modal-content\">\r\n        <div class=\"modal-body\">\r\n          <div class=\"form-floating mb-3\">\r\n            <input v-model=\"vacationHouse.name\" type=\"text\" class=\"form-control\" id=\"floatName\" placeholder=\"Title\">\r\n            <label for=\"floatName\">Title</label>\r\n          </div>\r\n          <div class=\"form-floating mb-3\">\r\n            <input v-model=\"vacationHouse.address\" type=\"text\" class=\"form-control\" id=\"floatAddress\" placeholder=\"Address\">\r\n            <label for=\"floatAddress\">Address</label>\r\n          </div>\r\n          <div class=\"form-floating mb-3\">\r\n            <textarea style=\"height: 100px\" v-model=\"vacationHouse.promoDescription\" type=\"text\" class=\"form-control\" id=\"floatPromoDescription\" placeholder=\"Description\"></textarea>\r\n            <label for=\"floatPromoDescription\">Description</label>\r\n          </div>\r\n          <div class=\"form-floating mb-3\">\r\n            <textarea style=\"height: 100px\" v-model=\"vacationHouse.behaviourRules\" type=\"text\" class=\"form-control\" id=\"floatBehaviourRules\" placeholder=\"Behaviour rules\"></textarea>\r\n            <label for=\"floatBehaviourRules\">Behaviour rules</label>\r\n          </div>\r\n          <div class=\"form-floating mb-3\">\r\n            <input v-model=\"vacationHouse.priceList\" type=\"text\" class=\"form-control\" id=\"floatPriceList\" placeholder=\"Price\">\r\n            <label for=\"floatPriceList\">Price</label>\r\n          </div>\r\n          <div class=\"form-floating mb-3\">\r\n            <textarea style=\"height: 100px\" v-model=\"vacationHouse.additionalInfo\" type=\"text\" class=\"form-control\" id=\"floatAdditionalInfo\" placeholder=\"Additional info\"></textarea>\r\n            <label for=\"floatAdditionalInfo\">Additional info</label>\r\n          </div>\r\n          <div class=\"form-floating mb-3\">\r\n            <input v-model=\"vacationHouse.cancellationConditions\" type=\"text\" class=\"form-control\" id=\"floatCancellationConditions\" placeholder=\"Cancellation conditions\">\r\n            <label for=\"floatCancellationConditions\">Cancellation conditions</label>\r\n          </div>\r\n          <div class=\"form-floating mb-3\">\r\n            <input v-model=\"vacationHouse.roomsQuantity\" type=\"text\" class=\"form-control\" id=\"floatRoomsQuantity\" placeholder=\"Rooms quantity\">\r\n            <label for=\"floatRoomsQuantity\">Rooms quantity</label>\r\n          </div>\r\n          <div class=\"form-floating mb-3\">\r\n            <input v-model=\"vacationHouse.bedsPerRoom\" type=\"text\" class=\"form-control\" id=\"floatBedsPerRoom\" placeholder=\"Beds per room\">\r\n            <label for=\"floatBedsPerRoom\">Beds per room</label>\r\n          </div>\r\n          <v-date-picker v-if=\"modalShown\" v-model=\"availabilityInterval\" :min-date=\"new Date()\" :from-date=\"fromDate\" mode=\"dateTime\" is-range is-expanded is24hr ></v-date-picker>\r\n        </div>\r\n        <div class=\"modal-footer\">\r\n          <button type=\"button\" @click=\"hideModal()\" class=\"custom-btn button-primary\" data-bs-dismiss=\"modal\">Close</button>\r\n          <button type=\"button\" @click=\"saveEdit()\" class=\"custom-btn button-primary\" data-bs-dismiss=\"modal\">Save changes</button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n  <div class=\"modal fade\" id=\"modalOffer\" tabindex=\"-1\" aria-hidden=\"true\">\r\n    <div class=\"modal-dialog\">\r\n      <div class=\"modal-content\">\r\n        <div class=\"modal-body\">\r\n          <div class=\"form-floating mb-3\">\r\n            <input v-model=\"offer.place\" type=\"text\" class=\"form-control\" id=\"floatPlace\" placeholder=\"Place\">\r\n            <label for=\"floatPlace\">Place</label>\r\n          </div>\r\n          <div class=\"form-floating mb-3\">\r\n            <input v-model=\"offer.clientLimit\" type=\"text\" class=\"form-control\" id=\"floatClientLimit\" placeholder=\"Client limit\">\r\n            <label for=\"floatClientLimit\">Client limit</label>\r\n          </div>\r\n          <div class=\"form-floating mb-3\">\r\n            <input v-model=\"offer.price\" type=\"text\" class=\"form-control\" id=\"floatPrice\" placeholder=\"Price\">\r\n            <label for=\"floatPrice\">Price</label>\r\n          </div>\r\n<!--          IZMENITI NA NOVI DATEPICKER I DODATI ADDITIONAL SERVICES-->\r\n          <Datepicker v-model=\"offerInterval\" :format=\"formatRange\" range/>\r\n        </div>\r\n        <div class=\"modal-footer\">\r\n          <button type=\"button\" @click=\"hideModal()\" class=\"custom-btn button-primary\" data-bs-dismiss=\"modal\">Close</button>\r\n          <button type=\"button\" @click=\"createOffer()\" class=\"custom-btn button-primary\" data-bs-dismiss=\"modal\">Create offer</button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport axios from \"axios\";\r\nimport { useRoute } from 'vue-router';\r\nimport {getCurrentInstance, onMounted, ref} from 'vue';\r\n\r\nexport default {\r\n  name: \"VacationHouseProfile\",\r\n  setup() {\r\n    const route = useRoute();\r\n    const toast = getCurrentInstance().appContext.config.globalProperties.$toast;\r\n\r\n    let id = ref('3');\r\n    let vacationHouse = ref({\r\n      id: null,\r\n      name: null,\r\n      address: null,\r\n      promoDescription: null,\r\n      availableFrom: null,\r\n      availableTo: null,\r\n      behaviourRules: null,\r\n      priceList: null,\r\n      additionalInfo: null,\r\n      cancellationConditions: null,\r\n      roomsQuantity: null,\r\n      bedsPerRoom: null,\r\n      reviewsNumber: null\r\n    });\r\n    let offer = ref({\r\n      id: null,\r\n      place: null,\r\n      clientLimit: null,\r\n      additionalServices: [],\r\n      price: null,\r\n      rentingEntityId: null,\r\n      start : null,\r\n      duration: null\r\n    });\r\n    let pictures = ref([]);\r\n    let modalShown = ref(false);\r\n    let availabilityInterval = ref({\r\n      start: undefined,\r\n      end: undefined\r\n    });\r\n    let offerInterval = ref();\r\n\r\n    let calendarAttributes = ref([\r\n      {\r\n        key: 'available',\r\n        highlight: {\r\n          start: { fillMode: 'outline' },\r\n          base: { fillMode: 'light' },\r\n          end: { fillMode: 'outline' }\r\n        },\r\n        dates: {\r\n          start: undefined,\r\n          end: undefined\r\n        }\r\n      }\r\n    ]);\r\n    let fromDate = ref();\r\n\r\n    onMounted(() => {\r\n      if (route.params.id !== undefined) {\r\n        id.value = route.params.id;\r\n      }\r\n      axios\r\n        .get(`/api/vacationHouses/anyUser/${id.value}`, {headers: {\"Authorization\" : `Bearer ${localStorage.getItem(\"jwt\")}`}})\r\n        .then(response => {\r\n          vacationHouse.value = response.data;\r\n          let from = stringToDateTime(vacationHouse.value.availableFrom);\r\n          let to = stringToDateTime(vacationHouse.value.availableTo);\r\n          availabilityInterval.value.start = from;\r\n          availabilityInterval.value.end = to;\r\n          calendarAttributes.value[0].dates.start = from;\r\n          calendarAttributes.value[0].dates.end = to;\r\n          fromDate.value = availabilityInterval.value.start;\r\n        });\r\n\r\n      axios\r\n        .get(`/api/vacationHouses/anyUser/${id.value}/pictures/all`, {headers: {\"Authorization\" : `Bearer ${localStorage.getItem(\"jwt\")}`}})\r\n        .then(response => {\r\n          for (let i = 0; i < response.data.length; i++) {\r\n            pictures.value.push(response.data[i]);\r\n          }\r\n        });\r\n    });\r\n\r\n    function showModal() {\r\n      modalShown.value = true;\r\n    }\r\n\r\n    function hideModal() {\r\n      modalShown.value = false;\r\n    }\r\n\r\n    function saveEdit(){\r\n      if(availabilityInterval.value.start != undefined && availabilityInterval.value.end != undefined) {\r\n        vacationHouse.value.availableFrom = dateTimeToString(availabilityInterval.value.start);\r\n        vacationHouse.value.availableTo = dateTimeToString(availabilityInterval.value.end);\r\n        calendarAttributes.value[0].dates.start = availabilityInterval.value.start;\r\n        calendarAttributes.value[0].dates.end = availabilityInterval.value.end;\r\n\r\n        axios\r\n            .put(`/api/vacationHouses/loggedVacationHouseOwner/${id.value}`, vacationHouse.value, { headers: {\"Authorization\" : `Bearer ${localStorage.getItem(\"jwt\")}`} })\r\n            .then(response => {\r\n              vacationHouse.value = response.data;\r\n              toast.success(\"Info updated\");\r\n            })\r\n            .catch(error => {\r\n              if (error.response.status === 401) {\r\n                toast.error(\"Error: Unauthorized access\");\r\n              } else if (error.response.status === 400) {\r\n                toast.error(\"Error: Invalid data\");\r\n              }\r\n            });\r\n      } else {\r\n        toast.error(\"Error: Invalid dates\")\r\n      }\r\n      modalShown.value = false;\r\n    }\r\n\r\n    function createOffer() {\r\n      offer.value.start = dateTimeToString(offerInterval.value[0]);\r\n      offer.value.duration = offerInterval.value[1] - offerInterval.value[0];\r\n      offer.value.rentingEntityId = id.value;\r\n\r\n      axios\r\n          .post(\"/api/offers/new\", offer.value, {headers: {\"Authorization\" : `Bearer ${localStorage.getItem(\"jwt\")}`}})\r\n          .then(response => {\r\n            offer.value = response.data;\r\n            toast.success(\"Info updated\");\r\n          });\r\n\r\n      modalShown.value = false;\r\n    }\r\n\r\n    function stringToDateTime(s) {\r\n      let tokens = s.split(\" \");\r\n      let date = tokens[0];\r\n      let time = tokens[1];\r\n\r\n      tokens = date.split(\".\");\r\n      let day = parseInt(tokens[0]);\r\n      let month = parseInt(tokens[1]) - 1;\r\n      let year = parseInt(tokens[2]);\r\n\r\n      tokens = time.split(\":\");\r\n      let hour = parseInt(tokens[0]);\r\n      let minute = parseInt(tokens[1]);\r\n\r\n      return new Date(year, month, day, hour, minute);\r\n    }\r\n\r\n    function dateTimeToString(dt) {\r\n      let day = (\"0\" + dt.getDate()).slice(-2);\r\n      let month = (\"0\" + (dt.getMonth() + 1)).slice(-2);\r\n      let year = dt.getFullYear();\r\n      let hour = (\"0\" + dt.getHours()).slice(-2);\r\n      let minute = (\"0\" + dt.getMinutes()).slice(-2);\r\n      return `${day}.${month}.${year} ${hour}:${minute}`;\r\n    }\r\n\r\n    const formatRange = (dates) => {\r\n      let from = dates[0];\r\n      let to = dates[1];\r\n\r\n      const dayFrom = from.getDate();\r\n      const monthFrom = from.getMonth() + 1;\r\n      const yearFrom = from.getFullYear();\r\n      const hourFrom = from.getHours();\r\n      const minuteFrom = from.getMinutes();\r\n\r\n      const dayTo = to.getDate();\r\n      const monthTo = to.getMonth() + 1;\r\n      const yearTo = to.getFullYear();\r\n      const hourTo = to.getHours();\r\n      const minuteTo = to.getMinutes();\r\n\r\n      return `${dayFrom}.${monthFrom}.${yearFrom} ${hourFrom}:${minuteFrom} - ${dayTo}.${monthTo}.${yearTo} ${hourTo}:${minuteTo}`\r\n    }\r\n\r\n    return {\r\n      id,\r\n      vacationHouse,\r\n      offer,\r\n      pictures,\r\n      modalShown,\r\n      availabilityInterval,\r\n      offerInterval,\r\n      calendarAttributes,\r\n      fromDate,\r\n      formatRange,\r\n      showModal,\r\n      hideModal,\r\n      stringToDateTime,\r\n      dateTimeToString,\r\n      saveEdit,\r\n      createOffer\r\n    }\r\n  }\r\n}\r\n\r\n</script>\r\n\r\n<style scoped>\r\n\r\n</style>"]},"metadata":{},"sourceType":"module"}